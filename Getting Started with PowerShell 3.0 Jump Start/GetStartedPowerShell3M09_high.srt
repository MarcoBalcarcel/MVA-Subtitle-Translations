1
00:00:00,333 --> 00:00:06,333
[Music]

2
00:00:17,483 --> 00:00:20,366
>> And we're back for our last session for today.

3
00:00:20,483 --> 00:00:21,466
>> Last session. Last and best.

4
00:00:21,483 --> 00:00:23,466
>> Last and best session for today. Guys, this is...

5
00:00:23,483 --> 00:00:26,466
>> Before we forget, we should just give a super shout out to

6
00:00:26,483 --> 00:00:29,433
the MVPs answering all those great questions. Hoorah.

7
00:00:29,450 --> 00:00:29,466
>> [Applause] Yeah.

8
00:00:29,483 --> 00:00:34,466
>> Thank you. And just representative example of the awesome PowerShell community.

9
00:00:34,483 --> 00:00:36,466
Join. Be part of the PowerShell community.

10
00:00:36,483 --> 00:00:37,466
>> Yep.

11
00:00:37,483 --> 00:00:38,466
>> Let's go.

12
00:00:38,233 --> 00:00:40,216
>> And so, guys, what we're going to do, is this is kind of a

13
00:00:40,300 --> 00:00:42,466
warmup for what we're going to do on August 1st where we go through

14
00:00:42,483 --> 00:00:45,466
all the details in this. This is more than just a warmup, though.

15
00:00:46,333 --> 00:00:48,466
You can start immediately using this today. I like to refer

16
00:00:48,483 --> 00:00:53,466
to this as immediately effective. And so let's start off with,

17
00:00:53,233 --> 00:00:58,466
though, thank God you're not physically in this room, because

18
00:01:00,483 --> 00:01:03,466
what I'm about to show you I've actually had people threaten

19
00:01:03,483 --> 00:01:04,466
to hit me.

20
00:01:04,483 --> 00:01:05,466
>> Oohh. I'm here.

21
00:01:05,233 --> 00:01:08,333
>> So you have to imagine that... no, don't hit me, man.

22
00:01:08,416 --> 00:01:10,466
Don't... you just got punched by Jeffrey Snover. That's going

23
00:01:10,483 --> 00:01:15,250
to look really good on my resume. So we've been spending all

24
00:01:15,333 --> 00:01:19,466
of our time in the console. And, God, I love the console and

25
00:01:19,200 --> 00:01:20,466
we've been working on commands, and here's what you want to do,

26
00:01:20,483 --> 00:01:24,200
you want to work stuff out in here, copy it, and, like we did

27
00:01:24,283 --> 00:01:26,466
earlier, paste it into a script. But I want to show you something

28
00:01:26,483 --> 00:01:31,433
that comes with PowerShell, and it's the ISE. And...

29
00:01:31,450 --> 00:01:31,466
>> Oohh.

30
00:01:31,483 --> 00:01:34,466
>> Yeah. And oohh. And this is... so I'm going to close this console.

31
00:01:34,483 --> 00:01:37,233
And, guys, I want to show you this real quick so that we can

32
00:01:37,316 --> 00:01:40,466
kind of get into it. But I'm going to start the ISE.

33
00:01:41,166 --> 00:01:43,283
And, you know, they're going to do that picture in picture thing,

34
00:01:43,366 --> 00:01:45,233
so let me lower this thing down here a little bit.

35
00:01:46,483 --> 00:01:50,0
Now, I'm going to show... don't yell at me, please. Don't yell

36
00:01:50,483 --> 00:01:52,466
at me. First of all, there's a scripting pane up here. Down here's

37
00:01:52,483 --> 00:01:56,200
a console pane. Then there's this commands pane. I'm going to

38
00:01:56,283 --> 00:02:01,466
simplify this screen real quick. Boink. And I want to show

39
00:02:01,483 --> 00:02:05,466
you these buttons across the top. You can have the scripting

40
00:02:05,483 --> 00:02:07,466
pane on top and a console on the bottom. You can have them side

41
00:02:07,483 --> 00:02:11,200
by side. Which if you have two monitors, this is awesome...

42
00:02:11,450 --> 00:02:11,466
>> Yeah....

43
00:02:11,483 --> 00:02:13,466
>> to put this between the dual monitors. But I'm going to make

44
00:02:13,483 --> 00:02:16,466
it even simpler. I'm just going to go to one pane and so I can

45
00:02:16,483 --> 00:02:21,466
kind of shorten things up a little bit here. And bring this

46
00:02:21,483 --> 00:02:24,466
down a little bit. Here's the part that you're going to threaten

47
00:02:24,483 --> 00:02:27,466
to beat me to death with. I'm going to hit control R. That flips

48
00:02:27,483 --> 00:02:31,466
me between the scripting pane and the console. And you might

49
00:02:31,483 --> 00:02:34,466
be asking yourself, well, this looks kind of like a console.

50
00:02:34,483 --> 00:02:38,466
Yeah, this is a damn fine console. Remember this morning when

51
00:02:38,483 --> 00:02:41,466
we were talking and Jeffrey was saying, hey, look, we can't touch

52
00:02:41,483 --> 00:02:43,466
that original console thing that...

53
00:02:44,0 --> 00:02:45,433
>> Oh, control R toggles.

54
00:02:45,450 --> 00:02:45,466
>> Huh?

55
00:02:46,0 --> 00:02:47,250
>> I didn't know that.

56
00:02:47,333 --> 00:02:48,466
>> What? Control R?

57
00:02:48,183 --> 00:02:48,466
>> Control R toggles.

58
00:02:48,483 --> 00:02:49,466
>> Yeah. It's awesome.

59
00:02:49,483 --> 00:02:53,466
>> Oh. I keep trying to remember control D versus control I.

60
00:02:53,200 --> 00:02:54,466
Like D, what the hell does D mean?

61
00:02:54,483 --> 00:02:56,466
>> No, I think Bruce Payette... I think Bruce Payette did something

62
00:02:56,483 --> 00:03:00,333
with control R, and I'm like, oh, oh, oh. So, yeah, control R.

63
00:03:00,416 --> 00:03:01,466
>> Well, I learned something.

64
00:03:01,483 --> 00:03:05,333
>> Oh, that's... yeah, right on, bro. So here's the deal.

65
00:03:06,483 --> 00:03:09,466
I'm going to type something here and you're going to see that

66
00:03:09,483 --> 00:03:12,466
this is not the console that you think we are. First of all,

67
00:03:12,483 --> 00:03:14,283
let me clear it up. Now watch.

68
00:03:14,483 --> 00:03:16,466
I'm going to do get...

69
00:03:17,250 --> 00:03:20,466
wooo, look at what it's doing. Look at what it's doing.

70
00:03:20,483 --> 00:03:22,466
Dude. This is like...

71
00:03:24,483 --> 00:03:28,233
it's intellisense helping me through here. This is like totally awesome.

72
00:03:28,316 --> 00:03:31,466
And watch. You might notice that it's also

73
00:03:33,483 --> 00:03:34,400
color syntax.

74
00:03:35,483 --> 00:03:38,466
So here's the deal. And we're going to ask Jeffrey about this,

75
00:03:38,483 --> 00:03:41,466
because this is the coolest thing in the world. You've got a

76
00:03:41,483 --> 00:03:45,466
console that has color syntax coding which helps a lot when you're

77
00:03:45,483 --> 00:03:49,466
typing to see if you're typing in error, and it's got this help

78
00:03:49,483 --> 00:03:52,183
flying at me as I'm typing.

79
00:03:53,483 --> 00:03:56,466
Is this your solution to the console going forward?

80
00:03:56,483 --> 00:03:57,466
>> Yeah, exactly.

81
00:03:57,483 --> 00:03:58,466
>> Because this makes it a lot easier.

82
00:03:58,483 --> 00:04:02,466
>> Yeah. Right. Spend a couple hours with this and stop asking

83
00:04:02,483 --> 00:04:03,466
me about improving the console.

84
00:04:04,483 --> 00:04:07,466
>> Which is what the thing was this morning is don't ask about

85
00:04:07,483 --> 00:04:10,466
improving the console because they're doing it right now.

86
00:04:10,483 --> 00:04:14,466
And this is the way to do it. So let's use this console and let's

87
00:04:14,216 --> 00:04:17,466
take a command here. Let's do a get WMI object. Yeah, it's okay,

88
00:04:17,483 --> 00:04:20,466
it's okay, it will all be good. Win32 underscore logical disk.

89
00:04:20,483 --> 00:04:22,466
I just want to show you... I want to get something to work.

90
00:04:22,483 --> 00:04:25,466
And I'm going to type something in you probably haven't seen before.

91
00:04:25,483 --> 00:04:33,466
You will. But I'm going to do device, filter on device, ID equals C.

92
00:04:34,483 --> 00:04:37,450
I want you to see what it gives me as an output. Well, absolutely

93
00:04:37,483 --> 00:04:39,466
nothing, because I screwed up the filter.

94
00:04:41,483 --> 00:04:45,250
And so what this command now gives me is it gives me some useful information.

95
00:04:45,333 --> 00:04:48,466
It's giving me... I'm having a scroll issue here. Hang on.

96
00:04:48,483 --> 00:04:51,466
It's giving my drive C and it gives me free space and size.

97
00:04:51,483 --> 00:04:55,466
I don't like the numbers, so I'm going to do something in flight.

98
00:04:55,483 --> 00:04:57,466
I want you no notice I'm building a command to make sure that

99
00:04:57,483 --> 00:05:00,466
it works first, and then I'm going to show you how easy cool

100
00:05:00,483 --> 00:05:05,466
this gets. So what I'd like is I'd like to select. And I'm only

101
00:05:05,483 --> 00:05:08,466
going to take one property for this demonstration. So I'd like

102
00:05:08,483 --> 00:05:11,466
to use the free space. But you know what I can't stand?

103
00:05:12,483 --> 00:05:14,466
Is, okay, let's just do free space.

104
00:05:15,483 --> 00:05:19,466
Watch. I don't know about you, but I don't really like that number

105
00:05:19,483 --> 00:05:23,466
because that number is like in bytes and it's like not making

106
00:05:24,333 --> 00:05:26,466
me happy because I want to see it in gigabytes or something like

107
00:05:26,483 --> 00:05:27,466
that because...

108
00:05:27,483 --> 00:05:28,433
>> Can I point something out?

109
00:05:28,450 --> 00:05:28,466
>> Yeah.

110
00:05:28,483 --> 00:05:35,466
>> Can you go back? So you did get get WMI object. Do get SIM object. Yeah. Wait.

111
00:05:35,483 --> 00:05:37,466
Yeah. No, let's start from scratch.

112
00:05:37,483 --> 00:05:39,466
>> Okay. Let's start from scratch.

113
00:05:39,483 --> 00:05:40,466
>> Yeah.

114
00:05:40,483 --> 00:05:42,166
>> You want... you want get SIM object.

115
00:05:42,250 --> 00:05:43,283
>> Get SIM object.

116
00:05:43,366 --> 00:05:45,466
>> Get SIM object. Or SIM instance.

117
00:05:45,483 --> 00:05:51,233
>> Instance, sorry. Yeah. And say Win32 logi-... and then tab.

118
00:05:51,316 --> 00:05:51,466
>> Tab.

119
00:05:51,483 --> 00:05:53,0
>> See the red right there?

120
00:05:53,483 --> 00:05:54,466
>> Oohh. Yeah, yeah, yeah. Oohh.

121
00:05:54,200 --> 00:05:54,466
>> Now, go back.

122
00:05:54,483 --> 00:05:57,466
>> Oh, I've gone too far. Oh, go back, go back, go back.

123
00:05:57,483 --> 00:06:00,466
>> Cancel, cancel, cancel. Logical. And then control space.

124
00:06:02,483 --> 00:06:03,466
Control space.

125
00:06:03,483 --> 00:06:05,466
>> Logical. And then control space.

126
00:06:05,483 --> 00:06:06,466
>> Yeah.

127
00:06:07,483 --> 00:06:08,466
>> Oohh.

128
00:06:08,483 --> 00:06:12,200
Oh. That's awesome.

129
00:06:12,283 --> 00:06:15,466
>> Intellisense against the WMI name spaces. Is that crazy?

130
00:06:15,483 --> 00:06:18,300
>> Oh, guys, when you start working with WMI, one of the hardest

131
00:06:18,383 --> 00:06:20,466
things is dealing with the name spaces and finding the classes.

132
00:06:20,483 --> 00:06:22,466
And this is one of the most important technologies out there.

133
00:06:22,483 --> 00:06:27,466
We haven't had time today to go through it, but this is awesome.

134
00:06:27,483 --> 00:06:28,466
>> Oh, yeah.

135
00:06:28,483 --> 00:06:31,216
>> Yeah. So you're going to be wanting to use get SIM instance

136
00:06:31,300 --> 00:06:33,466
instead of the old-fashioned command that I'm going to use right now.

137
00:06:33,483 --> 00:06:34,466
>> Okay.

138
00:06:34,483 --> 00:06:35,433
Okay.

139
00:06:36,450 --> 00:06:38,466
>> And so I'm going to do select free space. I can't stand that

140
00:06:39,483 --> 00:06:42,466
number, so I'm going to do a custom column, and I'm going to...

141
00:06:42,483 --> 00:06:44,466
just like we had done earlier, because I don't like that, I'm

142
00:06:44,483 --> 00:06:47,466
going to create my own. There's a reason I'm doing this, but

143
00:06:47,183 --> 00:06:49,466
don't panic, we're almost there. And so I'm going to call it

144
00:06:49,483 --> 00:06:55,466
free GB and... whoops. It would help if I put in something to

145
00:06:55,483 --> 00:06:56,466
tell it what I was doing.

146
00:06:57,483 --> 00:06:58,433
>> And...

147
00:06:58,450 --> 00:06:58,466
>> And...

148
00:06:58,483 --> 00:07:00,200
>> You're not showing the best practices.

149
00:07:02,483 --> 00:07:06,366
Hit cancel. Hit carriage... hit cancel up to the pipeline.

150
00:07:07,483 --> 00:07:09,466
Now hit carriage return.

151
00:07:09,483 --> 00:07:13,433
>> Oh. Well, but... but... but... well, it doesn't do that in

152
00:07:13,483 --> 00:07:14,466
the ISE. It does it only in the console.

153
00:07:15,483 --> 00:07:18,466
I know what you... so here's what Jeffrey is saying, and I'll

154
00:07:18,483 --> 00:07:21,433
show it to you in there, in here. Because I want you to see this.

155
00:07:21,483 --> 00:07:24,466
Because you guys... this will actually be really interesting.

156
00:07:25,166 --> 00:07:28,466
I want you to see that... watch. So I'm doing this long line

157
00:07:28,483 --> 00:07:32,300
here, get WMI object, Win32 underscore logical disk.

158
00:07:33,383 --> 00:07:36,316
Logical disk.

159
00:07:36,400 --> 00:07:39,466
Filter. And device ID

160
00:07:41,166 --> 00:07:45,466
equals C colon. And, guys, here's the thing, is that I want to...

161
00:07:45,483 --> 00:07:48,466
that's great and that's fine, that's dandy, but I'm going to

162
00:07:48,483 --> 00:07:52,0
start typing this long command that's going to be wrapping around.

163
00:07:52,483 --> 00:07:56,433
A really great way to work at the console is to realize that

164
00:07:56,483 --> 00:07:59,466
there are certain things that automatically give us line continuation,

165
00:07:59,483 --> 00:08:01,466
the pipeline being one of them. Watch what happens here when

166
00:08:01,483 --> 00:08:03,466
I strike enter after the pipeline.

167
00:08:04,483 --> 00:08:08,466
See these things [Making noise]? This means...

168
00:08:08,483 --> 00:08:10,216
>> How do you spell that?

169
00:08:10,300 --> 00:08:14,466
>> I'm not sure, but it means you're... we get it. You're still

170
00:08:14,483 --> 00:08:18,333
on the same line, just keep typing. So from here I can do my select.

171
00:08:19,233 --> 00:08:21,466
It becomes easier to read and it's easier to edit when you're

172
00:08:21,483 --> 00:08:28,466
doing stuff in real time. Select. And I'll do my at N equals

173
00:08:29,483 --> 00:08:37,466
free GB and... whoops. It's late in the day. E equals...

174
00:08:39,333 --> 00:08:40,466
and I'm going to take the current object across the pipeline,

175
00:08:41,483 --> 00:08:43,466
I'm going to grab its free space. And I want to see it in gigabytes,

176
00:08:43,483 --> 00:08:45,466
so I'm going to divide it by

177
00:08:46,483 --> 00:08:49,466
1 GB. We have these built-in things to help us with math, because

178
00:08:49,483 --> 00:08:52,466
I'm not good at math, so these help me with math. And so the

179
00:08:52,483 --> 00:08:56,466
number looks... strike enter on this line. Number looks better,

180
00:08:56,483 --> 00:08:58,466
but I'd like it all rounded up. So I'm just going to do this

181
00:08:58,483 --> 00:09:00,333
as an integer real quick.

182
00:09:00,483 --> 00:09:05,466
Now, I'm going to do it as an integer real quick but it's going

183
00:09:05,483 --> 00:09:07,466
to yell at me because I didn't run both lines.

184
00:09:09,166 --> 00:09:10,366
So let me do this.

185
00:09:10,450 --> 00:09:10,466
>> Oh, I'm sorry.

186
00:09:10,483 --> 00:09:14,466
>> No, that's fine, that's fine. And so as int. And...

187
00:09:14,483 --> 00:09:16,466
oops. Now I screwed something up.

188
00:09:16,166 --> 00:09:16,466
>> Brackets.

189
00:09:16,483 --> 00:09:18,466
>> Hang on. Brackets. I forgot the brackets.

190
00:09:19,483 --> 00:09:21,466
I'll get you good line of code.

191
00:09:22,400 --> 00:09:25,466
Don't panic. This is all in the slides too, so if I fail to type...

192
00:09:25,483 --> 00:09:29,466
boom. So I've got a nice line now. I've got something that's

193
00:09:30,0 --> 00:09:32,466
giving me information that I want. It's pretty cool, got it

194
00:09:32,483 --> 00:09:35,466
all worked out. What I'm going to do is cut and paste. Now, from

195
00:09:35,483 --> 00:09:38,466
here, you know, cut and paste is kind of hard to do, but if you

196
00:09:38,183 --> 00:09:41,466
did this over here, cut and paste is real easy to do, because

197
00:09:41,483 --> 00:09:44,466
you know what's funny is they figured out how to use things like,

198
00:09:44,483 --> 00:09:49,466
oh, let's see, this old technology called control C control V.

199
00:09:49,483 --> 00:09:52,466
So I'm going to say control C. I'm going to hit control R to

200
00:09:52,483 --> 00:09:54,466
flip the screen. I'm going to control V.

201
00:09:55,483 --> 00:09:59,466
Oh, yeah, baby. Now I've got my line. Now we're going to start

202
00:09:59,483 --> 00:10:01,466
having some fun because we're going to save this as a script

203
00:10:01,483 --> 00:10:03,466
right now. File. Save as.

204
00:10:05,366 --> 00:10:09,466
We'll save it here in my scripts folder. We're going to save

205
00:10:09,483 --> 00:10:12,166
it as... well, we did I love you. Let's do this as...

206
00:10:12,250 --> 00:10:15,466
let's just call it diskinfo.ps1.

207
00:10:15,483 --> 00:10:18,466
And I can run it from right here. If I run it, boom, shows me

208
00:10:18,483 --> 00:10:22,366
a result. Well, it helps if I clear the screen and everything

209
00:10:22,450 --> 00:10:26,433
else I typed. But I can run it. Boink. And it shows me the results.

210
00:10:26,450 --> 00:10:26,466
>> Happy, happy.

211
00:10:27,483 --> 00:10:29,350
>> I'm going to hit control R. Everything's good.

212
00:10:30,450 --> 00:10:33,466
Now we want to start adding stuff to this. So let's make this

213
00:10:33,483 --> 00:10:35,466
a little better. First of all, you know, this is a nice script

214
00:10:36,483 --> 00:10:38,466
and all this, but if I give it to somebody else, all's it's doing

215
00:10:38,183 --> 00:10:41,466
right now is getting information off the C drive on the local machine.

216
00:10:41,483 --> 00:10:42,466
That's not cool.

217
00:10:43,483 --> 00:10:45,466
I want it to be able to get it from

218
00:10:48,483 --> 00:10:51,466
whatever computer I want it to get it from. Now, I could sit

219
00:10:51,483 --> 00:10:52,466
here and hard code this.

220
00:10:54,316 --> 00:10:56,466
>> Dude, you didn't spell computer name right.

221
00:10:56,483 --> 00:10:58,466
>> I'm not spelling anything right. Computer.

222
00:11:02,483 --> 00:11:08,466
Name. Local host. And this will work, but... go ahead and save it.

223
00:11:09,483 --> 00:11:12,466
That's fine, but here's the problem.

224
00:11:13,483 --> 00:11:16,466
If I give this to a friend, what are they going to have to do?

225
00:11:17,483 --> 00:11:21,466
They're going to have to go in here and edit my script. And I

226
00:11:21,483 --> 00:11:24,466
don't want people editing my script. What could possibly go wrong?

227
00:11:24,483 --> 00:11:26,466
>> Especially if you digitally signed it.

228
00:11:26,483 --> 00:11:29,466
>> Especially if I digitally signed it. So what I'm going to

229
00:11:29,483 --> 00:11:32,466
do is let's do a simple concept. Let's make a variable up here

230
00:11:32,483 --> 00:11:34,183
called dollar sign computer name.

231
00:11:34,483 --> 00:11:38,366
And let's set it right now equal to local host just to have some

232
00:11:38,450 --> 00:11:42,466
value in there. And instead of... we'll put the variable in here.

233
00:11:42,483 --> 00:11:45,466
Now, this is kind of common to a lot of other scripting languages

234
00:11:45,483 --> 00:11:49,466
where what you would do is you put your variables up here so

235
00:11:49,483 --> 00:11:54,466
you'd make it easier for somebody to edit your script. I still

236
00:11:54,483 --> 00:11:58,316
don't like this whole editing my script thing, but I want you

237
00:11:58,400 --> 00:12:01,316
to see that this still works, right? All's I'm doing is putting

238
00:12:01,400 --> 00:12:04,466
it into dollar sign computer name, still prints it out, everything's cool.

239
00:12:06,483 --> 00:12:10,466
You know, let me show you how to test the script properly from

240
00:12:10,483 --> 00:12:14,466
the console, because I'm about to blow your mind. Something that

241
00:12:14,483 --> 00:12:18,466
these guys have done is awesome. So let's run the script from

242
00:12:18,216 --> 00:12:20,466
the console. Since a lot of scripts get run from the console,

243
00:12:20,483 --> 00:12:22,466
I actually like to test them from there.

244
00:12:23,483 --> 00:12:25,466
Yep, CD scripts.

245
00:12:26,483 --> 00:12:29,466
And so we called this disk info.

246
00:12:30,450 --> 00:12:30,466
Run it.

247
00:12:31,483 --> 00:12:32,466
We're good.

248
00:12:32,233 --> 00:12:32,466
>> Happy, happy.

249
00:12:32,483 --> 00:12:37,466
>> Happy, happy. But you know what? I've been learning PowerShell,

250
00:12:37,483 --> 00:12:42,466
and as an administrator, this isn't exactly what I expect. I expect...

251
00:12:42,483 --> 00:12:46,466
I don't want to go in and edit computer name. No, when we have

252
00:12:46,483 --> 00:12:50,466
commandlets and stuff, we get parameters that we can adjust.

253
00:12:50,483 --> 00:12:53,466
So you know what would be really cool I think? I think it'd be

254
00:12:53,483 --> 00:12:54,466
really cool if

255
00:12:55,483 --> 00:12:59,466
there's this special keyword called param.

256
00:13:00,483 --> 00:13:05,233
Open parentheses, close parentheses,

257
00:13:06,483 --> 00:13:09,0
indent, so that Jeffrey loves you.

258
00:13:09,450 --> 00:13:09,466
>> That's right.

259
00:13:10,483 --> 00:13:12,466
>> Make it look pretty. I want you guys to notice something.

260
00:13:12,483 --> 00:13:15,466
I'm going to save this. So I'm going to hit control S and save it.

261
00:13:15,483 --> 00:13:18,400
I'm going to go back to my PowerShell console.

262
00:13:20,483 --> 00:13:25,466
And watch this. I'm going to clear the screen, .diskinfo dash...

263
00:13:27,483 --> 00:13:28,166
oh.

264
00:13:29,300 --> 00:13:32,466
I just made a parameter.

265
00:13:32,483 --> 00:13:33,466
>> Oohh.

266
00:13:34,200 --> 00:13:37,466
>> It was so easy to make a parameter. So now I can type in any

267
00:13:37,483 --> 00:13:38,466
computer I want.

268
00:13:39,483 --> 00:13:42,466
Now, I'm not selecting out a computer name which we will fix,

269
00:13:43,166 --> 00:13:45,233
but I want you to kind of get the concept of

270
00:13:46,483 --> 00:13:48,466
I just put a variable in there. Matter of fact, let's do another one.

271
00:13:48,483 --> 00:13:49,466
Let's just call it bogus.

272
00:13:51,483 --> 00:13:53,466
Just so you can see... I'm going to go back here. Watch, watch,

273
00:13:53,483 --> 00:13:55,450
watch, watch. This is so cool.

274
00:13:57,183 --> 00:13:57,433
Let's do...

275
00:13:57,450 --> 00:13:57,466
>> Oohh.

276
00:14:00,483 --> 00:14:05,466
>> I'm making parameters on the fly for whatever I need.

277
00:14:05,483 --> 00:14:09,466
This is becoming what's called a parameterized script. And what

278
00:14:09,483 --> 00:14:11,400
you're getting is it's starting to

279
00:14:12,483 --> 00:14:16,366
smell, look, and feel more like a commandlet and it's making

280
00:14:16,450 --> 00:14:17,433
my life a little bit easier.

281
00:14:17,450 --> 00:14:17,466
>> Mmm.

282
00:14:18,166 --> 00:14:23,466
>> I'm liking this. So let's try this. There's another thing

283
00:14:23,483 --> 00:14:27,433
that would be really nice, is if for an instance, at least, gethelp.diskinfo.

284
00:14:27,450 --> 00:14:27,466
>> Yeah.

285
00:14:27,483 --> 00:14:31,466
>> Look at what PowerShell is doing?

286
00:14:32,450 --> 00:14:32,466
PowerShell is

287
00:14:34,466 --> 00:14:38,466
starting to build that syntax for me. But computer name, it

288
00:14:38,483 --> 00:14:43,300
says it's an object. No, let me go in here and you can strongly

289
00:14:43,383 --> 00:14:45,466
type what the variables are. We didn't have... haven't talked

290
00:14:45,483 --> 00:14:50,350
much about that, but I what this to be a string so when I go

291
00:14:50,433 --> 00:14:51,466
out here and do this again,

292
00:14:53,483 --> 00:14:56,466
notice it's now making it a string. And I want you to notice

293
00:14:56,483 --> 00:14:59,466
that between the chihuahuas, it says string, it doesn't say that

294
00:14:59,483 --> 00:15:02,466
it can take multiple objects. We don't have any of the binkies

295
00:15:02,233 --> 00:15:05,466
in there. So here's how we put binkies

296
00:15:07,233 --> 00:15:09,350
in there.

297
00:15:09,383 --> 00:15:09,400
>> Oohh.

298
00:15:09,450 --> 00:15:09,466
>> Oohh.

299
00:15:09,483 --> 00:15:16,466
And I'm starting to actually get syntax now built on these parameters.

300
00:15:17,416 --> 00:15:20,466
And the only thing I've had to do so far is add one keyword different

301
00:15:20,483 --> 00:15:22,466
from what I'm used to and this one called param.

302
00:15:23,483 --> 00:15:24,466
But, wait, there's more.

303
00:15:24,483 --> 00:15:26,466
>> But wait, it's better.

304
00:15:27,350 --> 00:15:29,466
>> We're going to turn something on so that you can use

305
00:15:30,483 --> 00:15:31,466
parameter attributes.

306
00:15:31,483 --> 00:15:32,466
>> Yeah. Yeah, yeah, yeah. Yeah.

307
00:15:32,483 --> 00:15:34,466
>> So let's do commandlet binding.

308
00:15:37,483 --> 00:15:39,466
This turns on something called parameter attributes. And here's

309
00:15:39,483 --> 00:15:41,433
the thing. I don't really want to have local host in here.

310
00:15:41,450 --> 00:15:41,466
>> Oh...

311
00:15:41,483 --> 00:15:43,466
>> What I want to do... oh, what do you want me to do? What?

312
00:15:43,483 --> 00:15:44,466
>> Just hit save.

313
00:15:44,483 --> 00:15:45,466
>> Just hit save. Yeah? Yeah?

314
00:15:45,483 --> 00:15:47,466
>> And now do get help.

315
00:15:47,483 --> 00:15:48,466
>> Okay. Oh, I see what you... okay.

316
00:15:48,483 --> 00:15:49,433
Now...

317
00:15:49,483 --> 00:15:51,466
>> He added one line of code.

318
00:15:51,483 --> 00:15:52,450
>> One line.

319
00:15:52,483 --> 00:15:56,350
>> One line of code. And watch what happens. What?

320
00:15:56,433 --> 00:15:57,466
>> Well, that wasn't... that wasn't very...

321
00:15:57,483 --> 00:15:58,466
>> Did you save it?

322
00:15:58,216 --> 00:16:01,433
>> Did I save it? I think I saved it. Oh, well, we got common parameters.

323
00:16:01,450 --> 00:16:01,466
So, yeah...

324
00:16:01,483 --> 00:16:02,466
>> Oh, yeah, okay....

325
00:16:02,200 --> 00:16:05,466
>> it did it, we just need to do the... yeah, so we got common parameters.

326
00:16:05,483 --> 00:16:09,466
So this is actually making the syntax full. Watch. Watch.

327
00:16:09,483 --> 00:16:12,466
So commandlet binding will let us use something called parameter

328
00:16:12,483 --> 00:16:16,250
attributes, things like making things mandatory. Let me show

329
00:16:16,333 --> 00:16:20,216
you an example. I'm going to get rid of this default and

330
00:16:22,483 --> 00:16:26,466
I'm going to go in here and I'm going to say parameter...

331
00:16:27,483 --> 00:16:30,283
I got to spell this right... mandatory...

332
00:16:30,483 --> 00:16:37,466
mandatory... equals true. And I think I got the syntax correct.

333
00:16:37,483 --> 00:16:40,233
Now, I want to point out that this is a parameter attribute.

334
00:16:40,316 --> 00:16:42,466
I'm going to say mandatory is true. It only affects the next

335
00:16:42,483 --> 00:16:46,283
parameter after it. It's not going to affect bogus. So watch.

336
00:16:47,483 --> 00:16:49,466
Look at what happens to the syntax on this.

337
00:16:49,483 --> 00:16:55,466
Notice up here I had the brackets around it. Now look.

338
00:16:55,483 --> 00:16:58,316
There's no brackets around that. This is going to become mandatory.

339
00:16:58,400 --> 00:17:02,466
So watch as I start to try to run this. I'm going to do disk info.

340
00:17:02,483 --> 00:17:06,466
I'm going to run it. You've got to give me a computer name, man,

341
00:17:07,200 --> 00:17:08,466
so it's mandatory now.

342
00:17:09,483 --> 00:17:13,466
DC. And now it works. I can do it. I made it mandatory. I can

343
00:17:13,483 --> 00:17:18,466
also then do... of course I've got the actual parameter. So in

344
00:17:18,483 --> 00:17:22,466
just two lines of code we're making our own parameters on our

345
00:17:22,483 --> 00:17:26,466
script, a parameterized script, and we're getting syntax.

346
00:17:26,483 --> 00:17:28,466
But you know what? I want to be a nice guy when I give this to

347
00:17:28,483 --> 00:17:30,466
somebody else. I want to be a really nice guy. When I give it

348
00:17:30,483 --> 00:17:33,466
to you, I want to be a great guy. So what do you say we add

349
00:17:33,483 --> 00:17:35,466
in a little bit of help.

350
00:17:35,483 --> 00:17:36,466
>> Love it. Love it.

351
00:17:36,483 --> 00:17:43,466
>> Let's do some help. Guys, this is a block comment. Now, usually

352
00:17:43,483 --> 00:17:45,466
when you type in comments, see how they're in green?

353
00:17:45,483 --> 00:17:49,166
Usually the parsing engine there will just ignore what's ever

354
00:17:49,483 --> 00:17:52,466
in there. But with PowerShell, watch. I'm just going to type

355
00:17:52,483 --> 00:17:53,433
in a couple of things.

356
00:17:53,483 --> 00:17:58,466
Synopsis. I'm going to say this is the short explanation.

357
00:17:58,483 --> 00:18:02,333
It's okay if I have typing mistakes at this point because tired.

358
00:18:02,483 --> 00:18:07,216
Description. This is the long description. Yeah, everybody's

359
00:18:07,300 --> 00:18:09,466
going to be making fun of me because I can't type in. I'm going

360
00:18:09,483 --> 00:18:11,450
to type in parameter...

361
00:18:12,483 --> 00:18:16,466
whoops, whoops, whoops. Parameter. And I'm going to say computer name.

362
00:18:16,483 --> 00:18:21,466
And I'm going to say this is for remote computers. And just

363
00:18:21,483 --> 00:18:23,283
a couple more things here real quick.

364
00:18:23,366 --> 00:18:30,466
Example. Let's do an example of... oh, let's do disk info dash

365
00:18:30,483 --> 00:18:35,466
computer name, you know, remote. And let's do one more.

366
00:18:35,483 --> 00:18:38,466
This is for... this...

367
00:18:38,483 --> 00:18:39,466
>> Do we do an example?

368
00:18:40,450 --> 00:18:40,466
>> This...

369
00:18:40,483 --> 00:18:41,466
>> Oh.

370
00:18:41,483 --> 00:18:46,466
>> I can't type of at all. This is for a remote computer.

371
00:18:47,483 --> 00:18:51,466
Watch. Look, guys. Just a couple of things. This is going to

372
00:18:51,166 --> 00:18:52,466
be totally amazing.

373
00:18:55,483 --> 00:18:56,466
Watch, watch, watch. Get help.

374
00:18:59,483 --> 00:19:01,466
Looky. Does it

375
00:19:03,166 --> 00:19:04,300
look like PowerShell help now?

376
00:19:04,383 --> 00:19:04,466
>> Woo woo.

377
00:19:04,483 --> 00:19:08,466
>> Woo woo woo woo woo. So I've got name, synopsis, look, it's

378
00:19:09,483 --> 00:19:11,466
building the syntax, I got description. But, wait, that's the

379
00:19:11,483 --> 00:19:14,466
short help. Watch. Watch, watch, watch, watch, watch.

380
00:19:14,483 --> 00:19:19,433
Full... oh, now look what PowerShell's built for me. It shows

381
00:19:19,483 --> 00:19:23,466
me the parameters, parameter definitions. I've got an example

382
00:19:23,483 --> 00:19:26,466
down here. For crying out loud, this is what I want. I want

383
00:19:26,483 --> 00:19:28,466
to give this to somebody else that works for PowerShell because

384
00:19:28,483 --> 00:19:33,216
this is what they expect. Oh. This is making me so happy.

385
00:19:33,300 --> 00:19:34,466
>> No, can I just point something out?

386
00:19:34,483 --> 00:19:35,466
>> Yes, absolutely.

387
00:19:35,483 --> 00:19:37,466
>> I can never remember any of this.

388
00:19:37,483 --> 00:19:38,466
>> I can't remember any of this either.

389
00:19:38,483 --> 00:19:39,433
>> Well, you did.

390
00:19:39,483 --> 00:19:43,466
That's pretty good. I can't do that. So show them the amazing

391
00:19:43,483 --> 00:19:44,466
control J.

392
00:19:44,483 --> 00:19:47,466
>> So, guys, I'm going to hit...

393
00:19:47,483 --> 00:19:49,466
>> That's the only way I can deal with it.

394
00:19:49,483 --> 00:19:52,466
>> And here's the thing. And when we come back on August 1st,

395
00:19:52,483 --> 00:19:54,466
this is going to become one of your best friends. So I'm going

396
00:19:54,483 --> 00:19:57,433
to start a new tab. I'm going to hit control J. It's going to

397
00:19:57,483 --> 00:20:00,466
bring up snippets. Now, I want to point something out. Not quite

398
00:20:00,483 --> 00:20:03,466
done with this demonstration yet, but these snippets, look at

399
00:20:03,483 --> 00:20:08,466
this, commandlet snippet, it gives you the basics of putting

400
00:20:08,483 --> 00:20:12,466
this together. And the advanced one, the complete one is super

401
00:20:12,483 --> 00:20:15,466
rockin' cool. So we've got comment blocks, we've got some of

402
00:20:15,483 --> 00:20:18,466
the constructs and the loops that we're going to be using on

403
00:20:19,483 --> 00:20:23,466
August 1st that you'll be able to work with to help you build this.

404
00:20:24,483 --> 00:20:29,466
So you can actually pick a snippet and, look, it auto creates

405
00:20:30,216 --> 00:20:33,466
all these possibilities for you. And, oh, look, it... see?

406
00:20:33,483 --> 00:20:35,466
All's you got to do now is just go in and...

407
00:20:35,200 --> 00:20:38,466
>> So if you are a deeply flawed human like me and cannot spell

408
00:20:39,0 --> 00:20:41,466
synopsis, control J.

409
00:20:41,483 --> 00:20:45,466
>> Yeah, this is what my problem is. So you can use this as a

410
00:20:45,483 --> 00:20:49,466
template to fill it up. But, wait, there's more. We're not done yet.

411
00:20:49,483 --> 00:20:53,466
Because here's the deal. This is nice. This is a parameterized script.

412
00:20:53,483 --> 00:20:58,466
And you can do a lot of powerful things with parameterized scripts.

413
00:20:58,483 --> 00:21:01,466
But, you know, I want to take this to the next level just a little

414
00:21:01,483 --> 00:21:03,466
bit more so you can get an idea of where we're going to go on

415
00:21:03,483 --> 00:21:04,466
August 1st.

416
00:21:04,483 --> 00:21:05,466
>> Take it to 11.

417
00:21:05,483 --> 00:21:09,466
>> Take it to... my amp goes to 11, it does.

418
00:21:10,483 --> 00:21:15,466
So we're going to crank this bad boy up because my ISE goes to 11.

419
00:21:15,483 --> 00:21:16,466
Save script, no. Let's do this.

420
00:21:17,483 --> 00:21:21,216
So that you can see the typing, what I'm going to do is I'm going

421
00:21:21,300 --> 00:21:24,466
to remove the help for it right now. Okay? So don't freak out

422
00:21:24,483 --> 00:21:25,466
on me, I'm just going to...

423
00:21:25,483 --> 00:21:26,466
>> Wait. Why are you doing that?

424
00:21:26,483 --> 00:21:28,466
>> Well, because I want them to... oh, I guess I can just scroll...

425
00:21:28,483 --> 00:21:29,466
yeah, let's do this.

426
00:21:29,483 --> 00:21:30,466
>> No, no, no. Click the button.

427
00:21:30,483 --> 00:21:32,466
>> Oh, click the button.

428
00:21:32,483 --> 00:21:33,433
>> Collapse.

429
00:21:34,450 --> 00:21:34,466
>> Oh. Dude, that's...

430
00:21:34,483 --> 00:21:37,266
>> Because ISE goes to 11, dude.

431
00:21:37,350 --> 00:21:41,466
>> Because ISE goes to 11. So here we go. Guys, right now we're

432
00:21:41,483 --> 00:21:43,466
running this like a script. I don't know about you, but we ain't

433
00:21:43,483 --> 00:21:46,466
done this all day long. We haven't typed in and run this script.

434
00:21:46,483 --> 00:21:49,466
What we've been doing is we've been running things likes verb,

435
00:21:49,483 --> 00:21:52,466
dash, noun, verb, dash, noun.

436
00:21:52,483 --> 00:21:56,466
God, I'd like to do the same thing, too, if only I knew how.

437
00:21:56,483 --> 00:21:57,466
Well, here's how.

438
00:21:58,483 --> 00:22:00,466
Going to add one more keyword

439
00:22:01,483 --> 00:22:06,466
to your day of fun. Function. You need to give it a name.

440
00:22:07,483 --> 00:22:08,466
Now, we're going to give it a proper name.

441
00:22:09,483 --> 00:22:15,466
Verb dash noun. Don't do this, Gimmi dash stuff.

442
00:22:16,483 --> 00:22:19,466
No, gimmi is not on the approved verb list, so knock it off with

443
00:22:19,483 --> 00:22:21,466
making up your own verbs. There's...

444
00:22:21,483 --> 00:22:24,466
>> And everybody, you've got do it at least once, right?

445
00:22:24,483 --> 00:22:27,466
But, here, we're going to do get dash, and we're just going to

446
00:22:27,166 --> 00:22:30,466
call it disk info. Now, the function, it has an open squiggly

447
00:22:30,483 --> 00:22:33,466
and then when you're done with your code all the way at the end...

448
00:22:33,483 --> 00:22:36,466
>> But wait. Show them... forget it. Oh, we're going to do ISE later?

449
00:22:37,166 --> 00:22:38,466
>> Are we going to do what?

450
00:22:38,483 --> 00:22:41,466
>> Are we going to talk about ISE a lot next time?

451
00:22:41,166 --> 00:22:42,433
>> Yeah. Oh, yeah. Yeah, yeah.

452
00:22:42,450 --> 00:22:42,466
>> Okay.

453
00:22:42,483 --> 00:22:44,166
>> Well, what do you want them to see?

454
00:22:44,483 --> 00:22:45,466
>> Get rid of the last squiggle.

455
00:22:45,483 --> 00:22:46,350
>> The last squiggle?

456
00:22:46,433 --> 00:22:47,466
>> Yeah. Get rid of that.

457
00:22:47,200 --> 00:22:48,300
>> Get rid of the last squiggle?

458
00:22:48,383 --> 00:22:50,433
>> Yeah. Okay. See the first squiggle? See that squig-...

459
00:22:50,450 --> 00:22:50,466
see the yellow?

460
00:22:50,483 --> 00:22:53,0
>> See the red? Oh, yeah, yeah, yeah.

461
00:22:53,450 --> 00:22:53,466
>> Missing closing...

462
00:22:54,166 --> 00:22:57,466
>> Missing close... so it's trying to help us understand where

463
00:22:57,483 --> 00:22:58,466
we're making mistakes.

464
00:22:58,483 --> 00:22:59,466
>> Isn't that cool? So you see the little squiggle. It's actually

465
00:22:59,483 --> 00:23:00,466
pretty useful. Really useful.

466
00:23:00,483 --> 00:23:03,466
>> And you guys see on the screen the little red squiggly that

467
00:23:03,183 --> 00:23:05,366
Jeffrey's talking about is this one right here? And so if you

468
00:23:05,450 --> 00:23:08,416
leave your mouse over it, it tells you, hey, you're missing something

469
00:23:08,483 --> 00:23:09,466
here, bro, and in this case...

470
00:23:09,483 --> 00:23:10,466
>> Dude.

471
00:23:10,483 --> 00:23:11,466
>> Dude. And so...

472
00:23:11,483 --> 00:23:12,0
>> Dude....

473
00:23:12,483 --> 00:23:13,466
>> we're missing that bottom squiggly.

474
00:23:13,483 --> 00:23:15,466
>> You'll let go into like 2.

475
00:23:15,483 --> 00:23:16,466
>> Yeah.

476
00:23:16,166 --> 00:23:16,466
[Laughter]

477
00:23:16,483 --> 00:23:21,266
>> Exactly. So I'm going to indent this so that it's easier to read.

478
00:23:21,483 --> 00:23:25,466
So you can see that I have a function. Now, don't do what I'm

479
00:23:25,483 --> 00:23:28,466
about to do, because this is just... I'm going to show you something

480
00:23:28,233 --> 00:23:30,466
much cooler than this. I'm going to save this. And I want to

481
00:23:30,483 --> 00:23:33,466
show you. Here's one of the interesting things. I'd like to

482
00:23:34,333 --> 00:23:37,466
run that script and then use that function. Well, here's the

483
00:23:37,183 --> 00:23:40,466
challenging thing. Watch. If I run disk info and I hit enter,

484
00:23:41,166 --> 00:23:44,466
what happens when you run a script is the script runs, it executes,

485
00:23:45,350 --> 00:23:49,216
and then everything is discarded out of memory. This is a good thing.

486
00:23:49,300 --> 00:23:52,283
But here's the problem. I just ran a script and it has a function

487
00:23:52,366 --> 00:23:55,466
called get disk info. So what happened is the script just ran,

488
00:23:55,483 --> 00:23:58,466
it just made this function up in memory for me, and when the

489
00:23:59,166 --> 00:24:04,350
script ended, it just killed it. So there is no get disk info.

490
00:24:04,433 --> 00:24:05,466
>> No, not so much.

491
00:24:05,166 --> 00:24:07,466
>> So I'm going to show you a unique way to do this. Now, this

492
00:24:07,483 --> 00:24:10,466
is great way for testing, but I got a better solution for you.

493
00:24:11,450 --> 00:24:11,466
>> Mmm.

494
00:24:11,483 --> 00:24:12,466
>> Dot space.

495
00:24:13,416 --> 00:24:13,466
>> Oh, showing them the dot.

496
00:24:13,483 --> 00:24:15,466
>> Dot back slant... I know, I know...

497
00:24:15,483 --> 00:24:17,466
>> I love it. No, it's awesome.

498
00:24:17,183 --> 00:24:21,466
>> This retains the stuff in your script in memory. So watch.

499
00:24:21,483 --> 00:24:22,433
I'm going to run it.

500
00:24:22,483 --> 00:24:23,466
>> That's not the right explanation.

501
00:24:23,483 --> 00:24:25,466
>> Okay. But, well, then you tell them.

502
00:24:25,483 --> 00:24:28,466
>> Okay. So here's the way it works. So what happens is there's

503
00:24:28,483 --> 00:24:32,466
a stack, right, and so what happens is when you run something

504
00:24:32,483 --> 00:24:36,466
in general you create a new stack and you put all your variables

505
00:24:36,483 --> 00:24:40,350
in that stack and then when you do an exit or a return that stack

506
00:24:40,433 --> 00:24:43,466
goes away and they all get cleared up. When you dot something,

507
00:24:43,483 --> 00:24:46,466
what happens is it runs... it doesn't create a new stack, it

508
00:24:46,483 --> 00:24:50,466
runs it in the current stack. So any new variables or anything

509
00:24:50,483 --> 00:24:53,466
that gets created, they get created here. When you exit, you

510
00:24:53,483 --> 00:24:55,416
just exit. But they stick around.

511
00:24:55,483 --> 00:24:56,283
>> But they stick around.

512
00:24:56,366 --> 00:24:56,383
>> Yeah.

513
00:24:56,450 --> 00:24:56,466
>> So...

514
00:24:59,483 --> 00:25:02,466
>> Dot sourcing. You UNIX guys will... you've like caught right

515
00:25:02,483 --> 00:25:03,466
on to this. This is dot sourcing.

516
00:25:03,483 --> 00:25:06,350
>> But isn't that what I said, only not nearly as well as you

517
00:25:06,433 --> 00:25:07,300
said it.

518
00:25:07,383 --> 00:25:07,466
>> Okay.

519
00:25:07,483 --> 00:25:11,466
>> Okay. So watch. Get disk. Watch. I'm going to hit tab completion

520
00:25:11,483 --> 00:25:14,0
at this point. Get disk. Get disk image. Get disk.

521
00:25:14,450 --> 00:25:14,466
>> Woo.

522
00:25:14,483 --> 00:25:18,333
>> Hey. Tab completion. Look. Looks like a commandlet.

523
00:25:18,483 --> 00:25:23,466
Looky, looky, looky. Computer name. DC. We are rock and roll.

524
00:25:23,483 --> 00:25:26,466
I don't like having them do this dot source stuff.

525
00:25:26,483 --> 00:25:29,466
>> Boy, did you... when you hit that commandlet... by the way,

526
00:25:29,483 --> 00:25:30,216
do it again. Do it again.

527
00:25:30,300 --> 00:25:30,466
>> Do it again?

528
00:25:30,483 --> 00:25:31,466
>> Up arrow, up arrow.

529
00:25:31,483 --> 00:25:32,333
>> Up arrow.

530
00:25:33,250 --> 00:25:39,333
>> Dash O tab. Oohh.

531
00:25:39,483 --> 00:25:40,466
>> Oh. Out... oh. Out variable.

532
00:25:40,483 --> 00:25:41,316
>> Out variable.

533
00:25:41,400 --> 00:25:42,466
>> So let's...

534
00:25:42,483 --> 00:25:43,0
>> A.

535
00:25:43,483 --> 00:25:44,0
>> What do you want to call it, A?

536
00:25:44,483 --> 00:25:45,433
>> A. Everything's A.

537
00:25:45,483 --> 00:25:46,466
>> Everything's A.

538
00:25:46,166 --> 00:25:47,166
>> Yeah, dollar sign A.

539
00:25:47,483 --> 00:25:50,300
>> Dollars sign A. So now I'm going to let you guys see that it

540
00:25:50,383 --> 00:25:52,466
just sent it out to the variable, some of those common parameters

541
00:25:52,483 --> 00:25:55,466
that we can use. So now we've got this stuffed into a variable.

542
00:25:55,483 --> 00:25:56,466
It's awesome.

543
00:25:56,483 --> 00:25:59,383
>> So what that meant was when you put that commandlet binding

544
00:25:59,466 --> 00:26:03,433
there, it said common parameters, there's a bunch of common parameters,

545
00:26:03,483 --> 00:26:06,250
and these are functions, you know, just by putting that one thing

546
00:26:06,333 --> 00:26:08,466
on you say, hey, PowerShell engine, could you do some stuff,

547
00:26:08,483 --> 00:26:12,466
work for me, could you like give them... I'll put variable and

548
00:26:12,183 --> 00:26:15,466
then could you do like error action and error variable and warning

549
00:26:15,483 --> 00:26:18,466
action and warning variable? Oh, really cool stuff.

550
00:26:18,483 --> 00:26:21,466
>> Well, you know, let's take this one step further, and you can

551
00:26:21,483 --> 00:26:25,466
certainly throw stuff into this, but, guys, this is going to

552
00:26:25,483 --> 00:26:29,166
be meat of what we do on August 1st.

553
00:26:29,250 --> 00:26:29,466
>> Yeah.

554
00:26:29,483 --> 00:26:33,466
>> And that's... you know, this is nice, but this isn't something

555
00:26:33,483 --> 00:26:36,466
quite yet what we refer to as an advanced function, although

556
00:26:36,483 --> 00:26:39,466
it's getting there, and what I want to be able to do is I don't

557
00:26:39,483 --> 00:26:42,466
want to have to dot source and run this as a script. That doesn't

558
00:26:42,483 --> 00:26:45,466
make sense to the junior admin that I want to give this to.

559
00:26:45,483 --> 00:26:47,466
>> It's really worth the investment. It's going to take some time.

560
00:26:48,166 --> 00:26:48,233
>> Right.

561
00:26:48,316 --> 00:26:49,466
>> It's not going to be the simplest thing in the world.

562
00:26:49,483 --> 00:26:52,166
It's going to take some time, but you really need to invest in

563
00:26:52,250 --> 00:26:56,466
learning about modules. Okay? Because modules are the future.

564
00:26:56,483 --> 00:26:57,466
They're really worth the investment.

565
00:26:57,483 --> 00:26:58,466
>> Yes.

566
00:26:58,483 --> 00:27:01,433
>> You know, why don't we just like settle in and teach them how

567
00:27:01,450 --> 00:27:01,466
to do it.

568
00:27:01,483 --> 00:27:04,466
>> And teach them how to do it. So you guys ready? Hey, hard core,

569
00:27:04,483 --> 00:27:05,466
here we go.

570
00:27:05,183 --> 00:27:05,216
>> Woohoo.

571
00:27:05,300 --> 00:27:05,466
>> Yeah. Wake up, wake up.

572
00:27:05,483 --> 00:27:07,316
>> We're going to hard core how to make a module.

573
00:27:07,400 --> 00:27:08,233
>> Wake up.

574
00:27:08,316 --> 00:27:10,466
>> First of all, I'm going to show you the cheesy way to make

575
00:27:10,483 --> 00:27:11,466
a module.

576
00:27:11,483 --> 00:27:12,466
>> Oh, cheesy.

577
00:27:12,483 --> 00:27:14,466
>> File. Save as.

578
00:27:16,466 --> 00:27:18,283
Notice my script?

579
00:27:23,166 --> 00:27:29,466
That's it. That's it. That's it. That's how you make a... PSM 1. Watch.

580
00:27:29,483 --> 00:27:30,466
Watch.

581
00:27:30,166 --> 00:27:33,466
>> You can now go to sleep.

582
00:27:33,483 --> 00:27:37,383
>> Yeah, you can... watch, watch, watch. Now, look, because it's

583
00:27:37,466 --> 00:27:40,466
not in the special place that we're going to talk about, I'm

584
00:27:40,483 --> 00:27:44,466
going to have to manually import this module and this module

585
00:27:45,483 --> 00:27:47,233
is called PSM1.

586
00:27:47,483 --> 00:27:50,466
So this is kind of like the old V2 way we'd always have to work

587
00:27:50,483 --> 00:27:51,466
with modules.

588
00:27:52,333 --> 00:27:53,350
>> Do dash, though.

589
00:27:53,433 --> 00:27:54,466
>> Oh, but watch. What?

590
00:27:54,483 --> 00:27:55,466
>> Do it again.

591
00:27:55,483 --> 00:27:56,466
>> What do you want to do?

592
00:27:56,483 --> 00:28:00,466
>> Do it again. Slash. Slash force slash verbose.

593
00:28:01,450 --> 00:28:01,466
>> You want to do...

594
00:28:02,333 --> 00:28:02,466
>> Dash force.

595
00:28:02,483 --> 00:28:03,233
>> Force?

596
00:28:03,316 --> 00:28:03,466
>> Force.

597
00:28:03,483 --> 00:28:04,466
>> Force?

598
00:28:04,483 --> 00:28:05,466
>> The other force.

599
00:28:05,483 --> 00:28:06,466
>> The other force.

600
00:28:06,483 --> 00:28:07,433
>> And then dash verbose.

601
00:28:07,450 --> 00:28:07,466
>> Verbose.

602
00:28:07,483 --> 00:28:09,433
>> And this just shows you...

603
00:28:09,450 --> 00:28:09,466
>> Verbose.

604
00:28:10,166 --> 00:28:11,466
>> Yeah. See?

605
00:28:11,483 --> 00:28:14,466
>> Ah, removing one of the imported. Oh, I love that. I love that.

606
00:28:14,483 --> 00:28:17,283
>> Yeah, it's importing the get disk info.

607
00:28:17,366 --> 00:28:19,466
>> And this is actually when you... and especially...

608
00:28:19,483 --> 00:28:21,466
especially on August 1st when we're working with, you know, you

609
00:28:21,483 --> 00:28:24,466
have to reload modules, you have to do... this is actually very

610
00:28:24,483 --> 00:28:28,466
useful to have around. So I've got a module that's imported.

611
00:28:28,483 --> 00:28:32,466
Now I can just do get disk info. But, you know, this is still

612
00:28:32,483 --> 00:28:35,466
not exactly the way that I want it because I don't want to have

613
00:28:35,483 --> 00:28:40,466
to say here's this thing, I made you this pretty module, it's

614
00:28:40,483 --> 00:28:44,466
a PSM1 file, and you're going to have to import every time you

615
00:28:44,483 --> 00:28:47,466
want to use anything in it. That just doesn't make sense.

616
00:28:47,483 --> 00:28:49,466
>> Dude, how hard was that? It was easy.

617
00:28:49,483 --> 00:28:52,466
>> I know it was easy, but you guys have like magical locations.

618
00:28:52,483 --> 00:28:53,466
>> Oh, there's the magic. Yes.

619
00:28:53,483 --> 00:28:54,466
>> Yeah. So...

620
00:28:54,200 --> 00:28:55,466
>> You're going to let them in on the secrets.

621
00:28:55,483 --> 00:28:58,466
>> Well, I don't know. Let's see. Can I catch ENV...

622
00:28:59,483 --> 00:29:02,466
is it PS module path that shows us all the magic?

623
00:29:03,483 --> 00:29:06,466
So there are two paths here.

624
00:29:06,483 --> 00:29:09,466
These are the magic locations right now as far as we're going

625
00:29:09,483 --> 00:29:13,466
to talk about, and the magic locations, if you put your module

626
00:29:13,483 --> 00:29:18,466
in these locations in a special way, they too will be dynamically loaded.

627
00:29:18,483 --> 00:29:20,433
>> Dude, what are you doing there? That's odd.

628
00:29:20,450 --> 00:29:20,466
>> What, what, what?

629
00:29:20,483 --> 00:29:22,466
>> I never do it that way.

630
00:29:22,166 --> 00:29:23,466
>> What do you want to do?

631
00:29:23,233 --> 00:29:23,466
>> Show it my way.

632
00:29:24,333 --> 00:29:24,466
>> Okay, well, do it your way.

633
00:29:27,483 --> 00:29:30,466
>> Okay, switch me. So what I do is I do... I do... oh, let's

634
00:29:30,483 --> 00:29:31,466
make this bigger.

635
00:29:31,483 --> 00:29:32,250
>> Woohoo.

636
00:29:32,483 --> 00:29:35,433
>> I do dollar sign. Okay?

637
00:29:35,450 --> 00:29:35,466
>> Wow.

638
00:29:35,483 --> 00:29:38,466
>> And that looks the same. But check this out. Because we need

639
00:29:38,483 --> 00:29:39,433
to do dollar sign...

640
00:29:39,450 --> 00:29:39,466
>> Dollar sign....

641
00:29:39,483 --> 00:29:40,466
>> we can do split.

642
00:29:40,483 --> 00:29:41,333
>> Split.

643
00:29:41,483 --> 00:29:42,466
>> Split. Split.

644
00:29:42,483 --> 00:29:43,466
>> Let's do it your way.

645
00:29:43,483 --> 00:29:44,466
Yeah.

646
00:29:46,483 --> 00:29:48,466
>> And then you break it out. Then you can read it.

647
00:29:48,483 --> 00:29:50,466
>> Yeah. Let's do it that way. Let's do it as...

648
00:29:50,483 --> 00:29:51,466
>> Okay. Let's switch back to him....

649
00:29:51,483 --> 00:29:55,466
>> split. Oops. So I can't spell split. I can spell spit, apparently.

650
00:29:56,483 --> 00:29:58,333
And what are we... we're doing on what, the semicolon?

651
00:29:58,416 --> 00:29:58,466
>> Semicolon.

652
00:29:58,483 --> 00:29:59,466
>> Yeah.

653
00:29:59,483 --> 00:30:00,466
>> There's quotes. Quotes.

654
00:30:00,483 --> 00:30:06,466
>> The quotes, quotes, quotes, quotes, quotes. Ah. Oh, now we

655
00:30:06,483 --> 00:30:08,466
can read the two paths. This makes a lot...

656
00:30:08,483 --> 00:30:09,466
>> Much better.

657
00:30:09,483 --> 00:30:12,466
>> So here's the first path that I want you guys to take notice of.

658
00:30:12,483 --> 00:30:15,333
This is the path. And I'm going to show this to you graphically

659
00:30:15,483 --> 00:30:17,466
for a second just so you can kind of see this. I'm going to

660
00:30:17,200 --> 00:30:20,466
go out. This where PowerShell gets installed. Windows System32.

661
00:30:21,483 --> 00:30:23,466
And there's a reason I'm showing it graphically. Sometimes this

662
00:30:23,483 --> 00:30:26,466
makes more sense. And so I'm going to go out where it says Windows

663
00:30:27,483 --> 00:30:32,466
PowerShell, and you'll see this folder called modules. And you

664
00:30:32,483 --> 00:30:36,200
see all these modules? These are modules. Here's the thing.

665
00:30:36,283 --> 00:30:37,433
Don't put yours here.

666
00:30:37,450 --> 00:30:37,466
>> Yeah.

667
00:30:37,483 --> 00:30:38,466
>> This is not for you.

668
00:30:39,483 --> 00:30:42,466
A lot of guys will say, oh, just put it in there because I know

669
00:30:42,483 --> 00:30:44,466
where it is, all that kind of stuff. No. Don't put your stuff there.

670
00:30:44,483 --> 00:30:48,466
This is the special place for Microsoft. You have your own special

671
00:30:48,483 --> 00:30:52,466
place, and that is this one.

672
00:30:54,483 --> 00:30:58,466
Your account documents Windows PowerShell modules. But this

673
00:30:58,483 --> 00:31:01,466
doesn't exist. Let me show you. Let me show you graphically.

674
00:31:01,483 --> 00:31:04,466
Sometimes this makes a little bit more sense. So I'm going to

675
00:31:04,483 --> 00:31:11,233
go out here to users, and I'll go out to student company is my account.

676
00:31:11,316 --> 00:31:12,466
And it's my documents through here.

677
00:31:13,483 --> 00:31:17,466
You see, there's no module called Windows PowerShell and there's

678
00:31:17,483 --> 00:31:22,466
nothing called modules. So you will need to make it. Now, I

679
00:31:22,483 --> 00:31:25,433
know, I'm making it graphically just because I happen to be here,

680
00:31:25,483 --> 00:31:29,466
but you can do it with PowerShell of course. Windows PowerShell.

681
00:31:29,483 --> 00:31:32,316
And then underneath of it, you make...

682
00:31:34,200 --> 00:31:36,466
it'd been faster if I'd done it in PowerShell. Oh, my God.

683
00:31:36,483 --> 00:31:38,466
What the hell's the matter with me? So modules...

684
00:31:39,333 --> 00:31:40,466
>> Because now you're going to have to type it right.

685
00:31:40,483 --> 00:31:42,466
>> Now I'm going to have to type it right. Now, here's the thing.

686
00:31:42,483 --> 00:31:44,466
And this is very, very important.

687
00:31:45,483 --> 00:31:50,466
The name of your module... you know the thing I call diskinfo.psm1

688
00:31:52,333 --> 00:31:55,466
needs to be the name of the folder that you're going to create here.

689
00:31:55,483 --> 00:32:00,466
They need to match. So I'm going to say new folder and I'm going

690
00:32:00,483 --> 00:32:02,466
to say disk info.

691
00:32:03,466 --> 00:32:06,466
Now, I've got this folder. Let's do this.

692
00:32:08,300 --> 00:32:12,466
I need to put my module in there. So let me go grab my module,

693
00:32:12,483 --> 00:32:14,466
which was this PSM1.

694
00:32:15,483 --> 00:32:16,466
Disk info.

695
00:32:17,483 --> 00:32:19,466
I'm going to take it, put it out to here.

696
00:32:20,483 --> 00:32:23,466
Oh, yeah, I should have never done this graphically, but, well,

697
00:32:23,183 --> 00:32:23,466
I'm here.

698
00:32:24,483 --> 00:32:26,466
I'm going to put it... now, here's the important thing. See?

699
00:32:26,483 --> 00:32:33,166
Look. Module name, the module folder name. And then the name

700
00:32:33,250 --> 00:32:34,466
of the dooder inside.

701
00:32:34,483 --> 00:32:38,350
Watch. Let's close this so you know I'm not cheating.

702
00:32:41,283 --> 00:32:44,466
Let's see. I wonder if I can get some help on...

703
00:32:44,483 --> 00:32:46,466
>> Wait. Did you start a fresh window? Is that a fresh window?

704
00:32:46,483 --> 00:32:48,233
>> Yeah. I started a brand-new one, >> Missed

705
00:32:48,316 --> 00:32:48,333
it.

706
00:32:48,416 --> 00:32:50,466
>> Started a brand new one. Oh. Here. Just in case anybody missed

707
00:32:50,483 --> 00:32:52,466
it, I don't want you to miss it, I'm not cheating. Let me close

708
00:32:52,483 --> 00:32:54,466
this thing out. I'm not cheating.

709
00:32:55,483 --> 00:32:58,466
Brand-new window. Get help.

710
00:32:59,483 --> 00:33:05,466
Is there anything... commandlets on disk information? Hmm.

711
00:33:05,483 --> 00:33:10,350
Hmm. Wait a minute, wait a minute, wait a minute. Hmm.

712
00:33:10,433 --> 00:33:11,466
>> Oh, right there first. Number one, baby.

713
00:33:11,483 --> 00:33:16,466
>> Hmm. Help found my commandlet inside my module. And, well,

714
00:33:16,483 --> 00:33:18,466
let's just try it. Get disk...

715
00:33:20,483 --> 00:33:22,466
not image, info. Dash computer name. DC. Oohh.

716
00:33:22,483 --> 00:33:23,466
>> Okay. The guys in

717
00:33:27,483 --> 00:33:30,466
the back... you can tell that we're getting up to the end of

718
00:33:30,483 --> 00:33:35,466
the day because the guys in the back are now going aahhh.

719
00:33:35,483 --> 00:33:40,466
So let me just show you the coding, and, Jeffrey, please go ahead

720
00:33:40,483 --> 00:33:43,466
and add in. So all's we're really doing is doing functions.

721
00:33:43,483 --> 00:33:46,466
We're properly naming them so that they look like commandlets.

722
00:33:46,216 --> 00:33:48,466
Notice I just gave it a little bit of help. There are about

723
00:33:48,483 --> 00:33:52,466
underscore comment based help files for this to help you with

724
00:33:52,483 --> 00:33:56,466
this or you can use control J to get the snippets. And notice

725
00:33:56,483 --> 00:34:01,183
I took a working line of code, the only thing I did was I added

726
00:34:01,266 --> 00:34:04,466
param, couple of variables in there, maybe an attribute, and

727
00:34:04,483 --> 00:34:07,466
believe me on August 1st we'll talk a lot more about attributes.

728
00:34:07,483 --> 00:34:08,466
>> Attributes rock.

729
00:34:08,483 --> 00:34:12,333
>> Oh, they totally rock. So with this simple little bit of code

730
00:34:12,416 --> 00:34:16,466
and saving it in the special place as a PSM1 file, I've made

731
00:34:16,166 --> 00:34:19,466
a module. In fact, like all modules, I'm not just going to put

732
00:34:19,483 --> 00:34:23,466
one function in here, I'm going to put as many functions...

733
00:34:23,483 --> 00:34:27,466
I'm going to make as many tools as I need, and I'm going to put

734
00:34:27,483 --> 00:34:31,466
them into this module. So I'll just make it foo and I'll make

735
00:34:31,483 --> 00:34:33,466
function bar.

736
00:34:34,483 --> 00:34:37,466
No, I know they're not properly named, but you get the idea.

737
00:34:37,483 --> 00:34:41,333
Now with that module, I'm just adding more and more tools to

738
00:34:41,416 --> 00:34:43,466
this module now. If you do that, save it.

739
00:34:44,350 --> 00:34:44,466
Save it.

740
00:34:44,483 --> 00:34:45,466
>> Save it?

741
00:34:46,483 --> 00:34:47,450
So...

742
00:34:48,483 --> 00:34:50,466
>> Import it. Import.

743
00:34:50,483 --> 00:34:53,466
>> Import module. And it's... I forgot the name.

744
00:34:53,483 --> 00:34:54,466
>> Disk info.

745
00:34:54,483 --> 00:34:55,466
>> Disk info, right?

746
00:34:55,166 --> 00:34:56,166
>> Yeah. Minus force.

747
00:34:56,483 --> 00:34:58,466
>> Force and verbose. Or...

748
00:34:58,483 --> 00:34:59,466
>> That's fine.

749
00:35:02,450 --> 00:35:02,466
Hmm.

750
00:35:03,333 --> 00:35:06,466
>> Oh, did you expect it to come up and do whole you're using a...

751
00:35:06,483 --> 00:35:07,283
>> Yeah.

752
00:35:07,366 --> 00:35:09,466
>> Not improved? You know, and what he's talking about is...

753
00:35:09,483 --> 00:35:11,466
and matter of fact I have to play with this, I think...

754
00:35:12,0 --> 00:35:12,466
>> Foo dash bar?

755
00:35:12,483 --> 00:35:17,466
>> Well, let's do gimmi dash foo.

756
00:35:19,483 --> 00:35:23,466
And, yeah, bar dash foo.

757
00:35:23,483 --> 00:35:24,466
And let me save it.

758
00:35:30,416 --> 00:35:31,466
>> Oh, you know what? It's the force. That's the problem.

759
00:35:31,483 --> 00:35:33,216
>> Oh, it's the force that's doing it.

760
00:35:33,300 --> 00:35:35,166
>> Yeah. So remove it. Remove it. Remove module.

761
00:35:35,483 --> 00:35:36,333
>> So remove module.

762
00:35:36,483 --> 00:35:41,466
>> By the way, so force basically says you're telling us we know

763
00:35:41,483 --> 00:35:44,466
what you're doing, ignore all the errors, just do what I told

764
00:35:44,483 --> 00:35:48,466
you to do, dang it. So watch what happens if you don't type force.

765
00:35:48,483 --> 00:35:52,166
>> And this is actually disk info.

766
00:35:55,483 --> 00:35:57,333
Oh, dude, I don't know why it's not saying it.

767
00:35:57,416 --> 00:35:58,466
>> Hmm. Interesting.

768
00:35:58,166 --> 00:35:59,466
>> Okay. I don't know why it's not saying it, but here's what

769
00:35:59,483 --> 00:36:02,450
usually happens. If you use an unapproved verb, it comes up and

770
00:36:02,483 --> 00:36:06,433
it says in yellow knock it off. Stop using unapproved verbs.

771
00:36:06,483 --> 00:36:07,466
>> Don't be a dope.

772
00:36:07,233 --> 00:36:09,466
>> Don't be a dope. So use approved verbs. And what are we doing

773
00:36:09,483 --> 00:36:15,466
on this... I see something up... it gives us... oh, oh, oh.

774
00:36:15,483 --> 00:36:18,466
I... they were trying to... you guys don't understand what's

775
00:36:18,483 --> 00:36:20,466
up on the teleprompters in here right now.

776
00:36:21,483 --> 00:36:25,466
The guys... the production team was trying to be f'ing funny.

777
00:36:25,483 --> 00:36:26,466
[Laughter]

778
00:36:26,483 --> 00:36:28,466
>> They didn't use the appropriate verb.

779
00:36:28,483 --> 00:36:31,0
>> And so, first of all, here's what they typed in so you all

780
00:36:31,483 --> 00:36:36,450
can see it. They said dollar sign mention this pipe to...

781
00:36:37,483 --> 00:36:39,466
and I can't even read what character they're using.

782
00:36:39,483 --> 00:36:40,466
>> Star? Is that star?

783
00:36:40,483 --> 00:36:43,466
>> This is... will you guys... up on sight,

784
00:36:44,483 --> 00:36:48,466
and then was it a squiggly? A squiggly.

785
00:36:48,200 --> 00:36:50,466
It gives

786
00:36:51,483 --> 00:36:53,466
us good feedback

787
00:36:54,483 --> 00:36:57,283
end squig-... this is... this is... have you guys been awake

788
00:36:57,366 --> 00:36:59,183
at all today? This is the crappiest PowerShell I

789
00:37:00,483 --> 00:37:03,466
have ever seen.

790
00:37:03,483 --> 00:37:08,466
>> This is remarkable. We've been busting our bums all day long,

791
00:37:08,483 --> 00:37:10,466
and you type this in?

792
00:37:10,483 --> 00:37:14,300
>> Please, one of the MVPs of the forums, somebody, you don't

793
00:37:14,383 --> 00:37:17,466
even have to be an MVP, take this and show them how it really

794
00:37:17,166 --> 00:37:19,466
should be done in the Cliff Note version.

795
00:37:19,483 --> 00:37:21,400
>> Yeah. Are you guys good at AV?

796
00:37:21,483 --> 00:37:23,466
>> I thought we had a Good Will Hunting moment there.

797
00:37:23,483 --> 00:37:24,466
[Laughter]

798
00:37:25,166 --> 00:37:28,466
>> Not so much. Good at AV? That's good. Keep doing that.

799
00:37:28,483 --> 00:37:29,466
>> Yeah, stay in AV.

800
00:37:29,483 --> 00:37:31,466
>> Stay in that.

801
00:37:31,483 --> 00:37:34,166
>> What I think they're trying to say is that there's a poll up.

802
00:37:34,250 --> 00:37:34,433
Am I correct?

803
00:37:34,450 --> 00:37:34,466
>> A poll.

804
00:37:34,483 --> 00:37:38,466
>> There's a poll up? And it's a real important poll. So make

805
00:37:38,483 --> 00:37:42,433
sure you do the poll up on the site because the feedback for

806
00:37:42,483 --> 00:37:43,433
this session is very important.

807
00:37:43,450 --> 00:37:43,466
>> Super important.

808
00:37:43,483 --> 00:37:46,466
>> As a matter of fact, we're starting to get kind of towards

809
00:37:46,483 --> 00:37:50,466
the end of what we've done for the day, but your feedback on

810
00:37:50,483 --> 00:37:52,266
the session is very important.

811
00:37:53,483 --> 00:37:57,466
Just so that you know, we're going to dive deep, deep, deep and

812
00:37:57,483 --> 00:38:00,466
we're going to do it in a day. So it's going to be definitely

813
00:38:00,483 --> 00:38:01,216
a day of...

814
00:38:01,300 --> 00:38:01,466
>> Chewy....

815
00:38:01,483 --> 00:38:06,466
>> chewy, chewy stuff into tool making, basically making tools.

816
00:38:06,483 --> 00:38:10,466
Going to show the different kind of parameter attributes, more

817
00:38:10,483 --> 00:38:14,466
about the help, how to... see, we've only scratched the surface.

818
00:38:15,416 --> 00:38:19,466
Our commandlet right now doesn't accept pipeline input, it's

819
00:38:19,483 --> 00:38:23,250
not making changes, so we're not supporting what if and confirm.

820
00:38:23,483 --> 00:38:27,466
And, you know, we might want to make our own views.

821
00:38:27,483 --> 00:38:30,283
There's so many things that we're going to want to do.

822
00:38:30,483 --> 00:38:33,466
So we've actually still got a lot of work to do. We're just

823
00:38:33,483 --> 00:38:35,466
not going to do much more of it today.

824
00:38:36,483 --> 00:38:37,366
So...

825
00:38:37,483 --> 00:38:38,466
[Laughter]

826
00:38:38,483 --> 00:38:40,466
>> Before we do a review, is there anything you want to add to

827
00:38:40,483 --> 00:38:43,466
the stuff we've done today, tell anybody anything?

828
00:38:43,233 --> 00:38:45,466
>> No, I think we... I think we've been having fun. We walked

829
00:38:45,483 --> 00:38:48,466
through a bunch of stuff, a ton more, a ton more. But, again,

830
00:38:48,483 --> 00:38:53,466
the key things I want you guys to walk away with are, one, this

831
00:38:53,200 --> 00:38:58,200
spirit of exploration, right? Go explore. Explore the help.

832
00:38:58,283 --> 00:39:01,466
Explore the help. Explore the help, explore the forums. Go out

833
00:39:01,483 --> 00:39:03,466
on the Internet, try some things.

834
00:39:04,483 --> 00:39:07,466
When you get confused, ask questions. Do not be embarrassed.

835
00:39:07,483 --> 00:39:10,466
Do not sit there and say, oh, that's a dumb question. No, no, no.

836
00:39:10,483 --> 00:39:13,466
Ask that question. You have a great community that will give

837
00:39:13,483 --> 00:39:14,466
you help.

838
00:39:15,483 --> 00:39:19,466
And just hopefully you've seen the sense of fun. There's just

839
00:39:19,183 --> 00:39:22,466
an incredible amount of power in PowerShell, and it's fun to

840
00:39:22,483 --> 00:39:25,466
do this exploration. By the way, and it's safe, too, because

841
00:39:25,483 --> 00:39:30,466
you go and you have the minus what if and the confirm and verbose.

842
00:39:31,483 --> 00:39:34,466
So, you know, it's... you can explore and you can have fun and

843
00:39:34,483 --> 00:39:35,466
do it safely.

844
00:39:35,483 --> 00:39:39,266
>> And do it safely. And notice that we've been having a lot of

845
00:39:39,350 --> 00:39:41,466
fun today because it's been a joy for the two of us to be able

846
00:39:41,483 --> 00:39:44,466
to spend the day talking with everybody about PowerShell.

847
00:39:44,483 --> 00:39:47,466
Because it is just a lot of fun, especially when you get past

848
00:39:47,483 --> 00:39:51,466
some of the learning curve stuff. So we did get help. And the

849
00:39:51,183 --> 00:39:55,433
amazing discoverability of get help, of finding commandlets,

850
00:39:55,483 --> 00:39:57,466
regardless of what product that you're working with, it will

851
00:39:57,483 --> 00:40:00,466
find it for you, and then you can go into the help files, the

852
00:40:00,483 --> 00:40:04,466
examples, the rich... the syntax that's in there, the definitions

853
00:40:04,483 --> 00:40:09,466
of the parameters. So get help is definitely number one tool.

854
00:40:09,483 --> 00:40:12,466
Something you definitely want to get good at, though, is that

855
00:40:12,483 --> 00:40:16,466
middle piece we did just after the meal break of understanding

856
00:40:17,283 --> 00:40:20,466
the pipeline and how the pipeline works. Because if you can't

857
00:40:20,483 --> 00:40:23,466
figure out how to get two commandlets to work together, you're

858
00:40:23,483 --> 00:40:27,350
just not going to have a lot of fun. That's so very important.

859
00:40:27,433 --> 00:40:30,466
So remember Don Jones has a great book on Learn Windows PowerShell

860
00:40:30,483 --> 00:40:32,466
in a Month of Lunches. It's chapter 9. I know it sounds like

861
00:40:32,483 --> 00:40:35,466
I'm trying to sell a book; I just want you to have more resource

862
00:40:35,483 --> 00:40:39,466
information on working through that. And go out to the forums

863
00:40:39,483 --> 00:40:43,466
on PowerShell.org and ask about that. Also the thing that really

864
00:40:43,483 --> 00:40:47,433
changes, and I have to say, you know, understanding the pipeline...

865
00:40:47,450 --> 00:40:47,466
>> Yep....

866
00:40:47,483 --> 00:40:49,466
>> that made a huge difference for me.

867
00:40:50,483 --> 00:40:54,466
When V2 shipped and remoting, that's what changed administration

868
00:40:54,483 --> 00:40:58,466
for me. And it's changed it forever. The remoting, being able

869
00:40:58,483 --> 00:41:01,466
to hit multiple machines, being able to do multiple things at

870
00:41:02,333 --> 00:41:04,466
once, being able to put those into scripts...

871
00:41:04,483 --> 00:41:05,466
>> Yep....

872
00:41:05,483 --> 00:41:09,166
>> has really, really made a huge... a huge difference.

873
00:41:09,483 --> 00:41:11,300
>> So that's the stuff everybody's, you know, partials run all

874
00:41:11,383 --> 00:41:14,350
of our Web sites and all of our big Internet sites, and then

875
00:41:14,433 --> 00:41:16,466
that's why, because they've got a gazillion of these things,

876
00:41:16,483 --> 00:41:17,466
how am I going to do things.

877
00:41:17,483 --> 00:41:19,466
>> How am I going to do things. And I think you guys have seen

878
00:41:19,483 --> 00:41:23,466
today a great example that PowerShell, you can learn it, you've

879
00:41:23,483 --> 00:41:25,300
learned a lot of it today, and......

880
00:41:25,383 --> 00:41:26,316
>> oh, you know what I didn't tell them about?

881
00:41:26,400 --> 00:41:27,466
>> What? What didn't you tell them?

882
00:41:27,200 --> 00:41:28,166
>> Our sacred vow.

883
00:41:28,483 --> 00:41:29,466
The sacred vow.

884
00:41:29,483 --> 00:41:33,466
So... so here's the sacred vow, the whole story behind the sacred vow.

885
00:41:33,483 --> 00:41:36,466
The sacred vow is basically the story that says, hey, you're

886
00:41:36,233 --> 00:41:38,466
IT pros, your hair's on fire, the last thing in the world...

887
00:41:38,483 --> 00:41:41,466
we know the last thing in the world you want to do is take your

888
00:41:41,483 --> 00:41:45,466
time to go learn a new tool. And yet here I am and I'm sitting

889
00:41:45,233 --> 00:41:49,466
here asking you to learn this new tool. And why? And the answer

890
00:41:49,483 --> 00:41:52,466
is because it's going to help you. And there's a set of things

891
00:41:52,483 --> 00:41:55,466
that you have to learn. You to learn the verbs, you have to learn

892
00:41:55,483 --> 00:41:58,466
the syntax, you have to learn the pipeline. And you have to

893
00:41:58,483 --> 00:42:01,466
learn how to do things, how to explore, et cetera. But my sacred

894
00:42:01,483 --> 00:42:06,183
vow to you is that if you learn those things, I'm going to do

895
00:42:06,266 --> 00:42:10,450
everything in my power to reuse those words, those concepts,

896
00:42:10,483 --> 00:42:15,466
those techniques over and over and over and over again so that

897
00:42:15,483 --> 00:42:19,466
your investment in learning is the best payback, the best investment

898
00:42:19,483 --> 00:42:23,466
you ever made. Now, let me get concrete about what that means.

899
00:42:23,483 --> 00:42:26,466
When we decided, hey, we need to support workflow, the original

900
00:42:26,483 --> 00:42:30,466
design for workflow was this very unusual thing, oh, you know,

901
00:42:30,483 --> 00:42:35,466
you got some weird syntax for workflow steps and workflow sequences

902
00:42:36,266 --> 00:42:40,466
and all that. And I said guys, whack, you forgot our sacred vow.

903
00:42:40,483 --> 00:42:43,466
Our sacred vow is they've already learned PowerShell. Use that

904
00:42:43,483 --> 00:42:47,466
over and over and over again. So now when you... when we teach

905
00:42:47,483 --> 00:42:50,183
you about workflow, what you're going to see is you just type...

906
00:42:50,266 --> 00:42:54,466
instead of function foo you type workflow foo. And then you

907
00:42:54,483 --> 00:42:58,466
write PowerShell. And the difference is that now it looks just

908
00:42:58,483 --> 00:43:02,466
like PowerShell except it's got very different semantics.

909
00:43:02,483 --> 00:43:06,466
It isn't run by the traditional PowerShell engine. We take that

910
00:43:06,483 --> 00:43:11,300
PowerShell syntax and we transcode it into a Windows workflow

911
00:43:11,383 --> 00:43:14,466
object graph and we give it to the windows workflow engine to

912
00:43:14,483 --> 00:43:19,466
execute its execution engine. But you, your experience, looks

913
00:43:19,483 --> 00:43:22,466
just like PowerShell, even though underneath the covers it's

914
00:43:22,483 --> 00:43:27,383
very, very different. Why? Because of our sacred vow. You learn

915
00:43:27,466 --> 00:43:30,466
this stuff and we're going to do it over and over and over again.

916
00:43:30,483 --> 00:43:33,466
Use those techniques over and over and over again. You learn

917
00:43:33,233 --> 00:43:36,466
how to manage exchange, you're going to be able to manage link.

918
00:43:36,483 --> 00:43:39,333
Having learned those two things, you're going to be able to learn

919
00:43:39,483 --> 00:43:44,250
how to manage Azure and SQL and all that because the sacred vow.

920
00:43:44,333 --> 00:43:45,466
We take that super serious.

921
00:43:45,483 --> 00:43:48,466
>> And I have to say, it's a great honor to sit here next to Jeffrey

922
00:43:48,483 --> 00:43:51,466
Snover, and it's been a great honor to be able to talk with members

923
00:43:52,166 --> 00:43:54,466
of the PowerShell team, because, guys, you got to realize, that

924
00:43:54,483 --> 00:43:59,466
sacred vow, they've stuck to it. They've stuck to it over several...

925
00:43:59,483 --> 00:44:02,466
the last five six years that I've been doing this. There's one

926
00:44:02,483 --> 00:44:05,466
guarantee that I've always had, and that's if I'm going to take

927
00:44:05,483 --> 00:44:07,466
the investment to learn this, they're not going to screw me on

928
00:44:07,483 --> 00:44:10,466
the back end by suddenly ripping everything out, replacing it

929
00:44:10,483 --> 00:44:13,466
and totally changing everything. Nope. I'm going to get commandlets,

930
00:44:13,483 --> 00:44:16,466
I'm going to get parameters. I've got a scripting environment

931
00:44:16,483 --> 00:44:19,466
that makes sense, that's stable, that's being moved forward.

932
00:44:19,483 --> 00:44:22,466
It's always going to be improved, but I know exactly what to expect.

933
00:44:23,483 --> 00:44:26,0
And I know what to expect when I go to active directory, to manage

934
00:44:26,483 --> 00:44:30,266
exchange, to manage whatever. It's the same. And that experience

935
00:44:30,350 --> 00:44:34,466
makes this initial investment a little painful at first, but

936
00:44:34,483 --> 00:44:38,466
it will pay off and it will pay off for years and years and years.

937
00:44:38,483 --> 00:44:42,333
And you've heard it from the architect, they are so totally committed

938
00:44:42,450 --> 00:44:42,466
to that.

939
00:44:43,0 --> 00:44:48,466
So little bit of information of how you get some more information.

940
00:44:48,483 --> 00:44:51,466
So let me just... yeah, we're going to leave your guys's mistake

941
00:44:52,483 --> 00:44:54,466
up on there, a very embarrassing thing that you did.

942
00:44:54,483 --> 00:44:59,166
>> And I want to just put up a couple of things for you all.

943
00:44:59,483 --> 00:45:02,466
First of all, you know that at the MVA, where you're at...

944
00:45:02,483 --> 00:45:06,466
or, yeah, MVS, MVA stuff, we're going to have another presentation.

945
00:45:06,483 --> 00:45:08,466
This is going to be on scripting and tool making.

946
00:45:09,483 --> 00:45:12,466
Now, it's on August 1st, but if you're watching this as a video,

947
00:45:12,483 --> 00:45:15,466
look for the next title, Scripting and Tool Making. So we're

948
00:45:16,333 --> 00:45:18,366
going to do that. It's going to be awesome. It's going to be

949
00:45:18,450 --> 00:45:21,466
totally awesome. A couple of other things. If you have a question,

950
00:45:21,483 --> 00:45:25,466
please don't... the only mistake you're going to make if you

951
00:45:25,483 --> 00:45:29,466
have a question is not ask it. So there are a couple of places

952
00:45:29,200 --> 00:45:32,466
you can go to get an answer. Of course PowerShell.org. I think

953
00:45:32,483 --> 00:45:36,466
I've said that like 15 times today. But, trust me, the community...

954
00:45:36,483 --> 00:45:38,466
nobody gets paid for this. We're doing it because we actually

955
00:45:38,483 --> 00:45:42,466
care and we want to help. Go ask a question; you'll get an answer.

956
00:45:42,233 --> 00:45:44,466
We've all been through this. I also want to give you something

957
00:45:44,483 --> 00:45:48,466
else, something that's kind of uncommon. I betcha you guys do this.

958
00:45:48,483 --> 00:45:51,466
But every time I talk to a group of IT pros, something happens

959
00:45:51,483 --> 00:45:54,466
that's kind of bizarre. I'll ask this question to a bunch of

960
00:45:55,166 --> 00:45:58,466
IT pros: How many of you use Twitter? And everybody will go like this.

961
00:46:00,483 --> 00:46:02,466
That's not the correct answer. Knock it off.

962
00:46:02,483 --> 00:46:06,466
>> So... and I'm not saying go... go... I'm not saying set up

963
00:46:06,483 --> 00:46:08,466
Twitter and start tweeting us what you had for lunch. As a matter

964
00:46:09,0 --> 00:46:10,466
of fact, don't do that, please.

965
00:46:11,483 --> 00:46:14,466
But you need to get a Twitter account, even if you just want

966
00:46:14,483 --> 00:46:17,466
to look, because where you're going to find the things that are

967
00:46:17,483 --> 00:46:23,250
going on is at a Twitter hashtag called hashtag PowerShell.

968
00:46:23,333 --> 00:46:26,300
That's where you're going to hear him, you're going to hear the MVPs.

969
00:46:26,383 --> 00:46:29,450
And I'm not saying that they're just talking about here's a cool command.

970
00:46:29,483 --> 00:46:32,466
No, you're going to see pointers to here's how I solved this

971
00:46:32,483 --> 00:46:36,466
exchange problem, here's how I solved this SCVMM issue.

972
00:46:36,483 --> 00:46:37,466
Here's how I built this.

973
00:46:38,483 --> 00:46:41,466
This is where the latest and greatest information is happening,

974
00:46:41,216 --> 00:46:44,466
so get on Twitter. And while you're out there on Twitter following

975
00:46:44,483 --> 00:46:45,466
the PowerShell stuff,

976
00:46:47,483 --> 00:46:48,466
there's always @jsnover.

977
00:46:50,200 --> 00:46:50,466
That's him.

978
00:46:51,483 --> 00:46:53,466
>> Show them how to... do they know how to use Twitter?

979
00:46:53,483 --> 00:46:54,216
>> Show what?

980
00:46:54,300 --> 00:46:55,466
>> Bring up IE.

981
00:46:56,483 --> 00:46:58,466
>> You want me to bring up the Twitter?

982
00:46:58,483 --> 00:46:59,466
>> The Twitter, yeah.

983
00:46:59,483 --> 00:47:04,466
>> Well, now, I'm just... the Twitter. And Twitter. I don't

984
00:47:04,483 --> 00:47:05,466
know if I can use it this way.

985
00:47:05,483 --> 00:47:06,200
>> Go ahead.

986
00:47:06,283 --> 00:47:08,350
>> You're going to have to help me. Because this is actually...

987
00:47:08,433 --> 00:47:10,466
>> How hard can it be?

988
00:47:11,483 --> 00:47:12,333
>> Well, I have to sign in.

989
00:47:12,416 --> 00:47:13,466
>> Don't you know how to do that?

990
00:47:13,483 --> 00:47:15,466
>> Well, okay. You want me to sign in? Really?

991
00:47:15,483 --> 00:47:16,466
>> Yeah.

992
00:47:16,483 --> 00:47:20,466
>> Okay. Don't laugh at my sign-in.

993
00:47:21,483 --> 00:47:32,466
It is what it is, guys. It just is what it is.

994
00:47:32,483 --> 00:47:34,466
>> Oops, I think I did the password wrong. Let me... let me...

995
00:47:35,483 --> 00:47:37,466
oh, wait a minute. I'm signing into my Twitter. You're going

996
00:47:37,483 --> 00:47:39,316
to see all the stuff that I follow.

997
00:47:39,400 --> 00:47:39,466
>> Well, just...

998
00:47:39,483 --> 00:47:42,366
>> Oh, wait a minute. Oh, for crying out loud. Why won't it let

999
00:47:42,450 --> 00:47:43,466
me in? Oh, wait a minute.

1000
00:47:43,483 --> 00:47:46,466
>> How hard can it be? How hard can it be?

1001
00:47:46,483 --> 00:47:49,333
>> Oh, wait a minute. Wait a minute. I know. I know. I know.

1002
00:47:49,483 --> 00:47:50,266
>> Oh, my lord.

1003
00:47:50,350 --> 00:47:53,466
>> I know. This is... I don't... this isn't how I get to it.

1004
00:47:54,483 --> 00:47:57,450
Oh, and now it's making me type in all the device stuff.

1005
00:47:57,483 --> 00:47:58,466
Are you kidding me, guys?

1006
00:47:58,483 --> 00:48:00,466
>> What? How hard can it be? Here, switch to mine.

1007
00:48:00,483 --> 00:48:02,466
>> Switch to his. I think his probably works.

1008
00:48:04,483 --> 00:48:08,466
Oh, there you go.

1009
00:48:08,183 --> 00:48:08,466
>> Did you finally get it?

1010
00:48:09,333 --> 00:48:10,466
>> No. We're looking at yours.

1011
00:48:11,483 --> 00:48:12,466
>> There's mine.

1012
00:48:12,483 --> 00:48:15,466
>> There's... there's... there's... let's see. Let me see if

1013
00:48:15,483 --> 00:48:20,433
I can finally get in. KS... what is that, a W? I hate these things.

1014
00:48:20,450 --> 00:48:20,466
EBA...

1015
00:48:20,483 --> 00:48:21,466
>> You're missing it.

1016
00:48:22,166 --> 00:48:26,466
>> What am I missing? Had a turkey sandwich for lunch.

1017
00:48:26,483 --> 00:48:27,466
>> Never mind.

1018
00:48:27,483 --> 00:48:29,466
>> That's... that's... I can't get signed into mine.

1019
00:48:29,483 --> 00:48:30,466
>> Twitter's awesome. Yeah.

1020
00:48:30,483 --> 00:48:32,466
>> So Twitter's awesome. So you're going to want to follow...

1021
00:48:32,483 --> 00:48:35,366
>> So here's the thing. Even if you can't get ahold of Twitter,

1022
00:48:35,450 --> 00:48:39,466
like obviously can't even use Twitter, but can use PowerShell.

1023
00:48:39,483 --> 00:48:40,250
So clearly PowerShell...

1024
00:48:40,333 --> 00:48:42,300
>> Did you guys see the problem I had with the Internet today

1025
00:48:42,383 --> 00:48:44,466
and he had to teach me... what was it is, the host file?

1026
00:48:44,483 --> 00:48:45,466
[Laughter]

1027
00:48:45,483 --> 00:48:47,466
>> NC hosts. Exactly.

1028
00:48:47,483 --> 00:48:48,316
>> NC hosts.

1029
00:48:48,400 --> 00:48:52,466
>> So if you can't use Twitter, it doesn't mean you can't use PowerShell.

1030
00:48:52,483 --> 00:48:55,466
>> That's right. That's right. So use PowerShell. So, ladies

1031
00:48:55,483 --> 00:48:59,466
and gentlemen, on behalf of the folks at MVA and of myself, I'd

1032
00:48:59,483 --> 00:49:03,466
like to thank you for attending this full-day session. And I

1033
00:49:03,200 --> 00:49:05,466
would really, sir, like to thank you...

1034
00:49:05,483 --> 00:49:06,366
>> Oh....

1035
00:49:06,450 --> 00:49:08,466
>> for spending the entire day. It's been such a great fun.

1036
00:49:08,483 --> 00:49:09,400
>> It's been a blast.

1037
00:49:09,483 --> 00:49:10,466
>> It's been a blast.

1038
00:49:10,233 --> 00:49:11,466
>> Had a great time with you.

1039
00:49:11,483 --> 00:49:12,466
>> I had a great time with you.

1040
00:49:12,483 --> 00:49:15,466
>> Don't you guys forget... remember, fill out those polls.

1041
00:49:15,483 --> 00:49:18,466
We really do... Microsoft really pays attention to that stuff.

1042
00:49:18,483 --> 00:49:20,466
You know, I know everywhere you go they're like, oh, yeah, fill

1043
00:49:20,483 --> 00:49:23,466
out the poll. No, no, no. We pay attention to that stuff.

1044
00:49:24,450 --> 00:49:28,283
If I get a bad mark, they'll fire me, so please, please, please...

1045
00:49:28,366 --> 00:49:31,466
>> Just saying. Just saying. Fill out the poll.

1046
00:49:31,483 --> 00:49:34,333
>> It's been a true honor to be able to...

1047
00:49:34,483 --> 00:49:36,466
>> [Inaudible] Yeah, exactly. It's been a true honor to have the

1048
00:49:36,483 --> 00:49:39,466
actual architect, Distinguished Engineer Jeffrey Snover, be able

1049
00:49:40,0 --> 00:49:42,200
to sit down and talk with us about PowerShell. God knows I've

1050
00:49:42,283 --> 00:49:46,350
learned a lot, and now I have to go and study because now I've

1051
00:49:46,433 --> 00:49:49,466
learned more and I have to study. Thank you sir. This has been wonderful.

1052
00:49:49,483 --> 00:49:50,433
Thanks a lot.

1053
00:49:50,450 --> 00:49:50,466
>> Yeah. Great.

1054
00:49:50,483 --> 00:49:52,466
>> Thanks a lot, guys, and thanks for joining us. We're going

1055
00:49:52,483 --> 00:49:54,466
to see you at the next one, scripting and tool making.

