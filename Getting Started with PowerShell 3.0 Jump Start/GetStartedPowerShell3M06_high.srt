1
00:00:01,483 --> 00:00:08,466
[Music]

2
00:00:18,483 --> 00:00:19,466
>> We're back. And I have to tell you,

3
00:00:19,483 --> 00:00:21,466
now we're going to talk about one of

4
00:00:21,483 --> 00:00:25,216
my most favorite things and you get to talk about.

5
00:00:26,0 --> 00:00:28,450
And we're going to do this twice, guys. We're going to do kind

6
00:00:28,483 --> 00:00:30,466
of a short section of this to get you started and then, we're

7
00:00:30,483 --> 00:00:33,466
going to get into scripting, teaching about variables and stuff,

8
00:00:33,483 --> 00:00:37,466
and then hit remoting this topic again with something called

9
00:00:37,483 --> 00:00:42,316
sessions that will be outstanding. But, remoting: this changed

10
00:00:42,483 --> 00:00:47,466
how I manage in scale when it comes to the entire Windows, the

11
00:00:47,483 --> 00:00:50,466
products, the platform, everything. This, when it released with

12
00:00:51,483 --> 00:00:55,316
Version 2, literally made me a hero overnight. So you have to

13
00:00:55,400 --> 00:00:58,166
tell us about what were you trying to solve with this.

14
00:00:58,250 --> 00:00:58,466
>> Sure.

15
00:00:58,483 --> 00:01:01,466
>> What does this thing do? This is unbelievable stuff.

16
00:01:01,483 --> 00:01:04,466
>> Yeah, so in PowerShell we have this idea... We talked a lot

17
00:01:04,483 --> 00:01:07,466
about it in the past; we don't talk so much about it now I guess

18
00:01:07,483 --> 00:01:10,450
because we already delivered it... this notion of universal

19
00:01:10,483 --> 00:01:14,466
code execution, which is to say that you have code and sometimes

20
00:01:14,483 --> 00:01:16,466
you want to run the code here.

21
00:01:16,483 --> 00:01:19,466
Yeah, that's what we do. Everything we've been showing you today,

22
00:01:19,483 --> 00:01:23,466
we bring up a console window and we type the code and the code

23
00:01:23,483 --> 00:01:28,466
runs here. But actually it's a generalization; here is a generalization

24
00:01:28,483 --> 00:01:32,466
or a specialization of anywhere. Like, sometimes I want to run

25
00:01:32,483 --> 00:01:36,466
the code there and sometimes I want to run the code there and

26
00:01:36,183 --> 00:01:39,466
sometimes I want to run the code on those machines.

27
00:01:40,483 --> 00:01:44,466
And sometimes I want to run the code on those machines on myself

28
00:01:44,216 --> 00:01:46,466
and sometimes I want to give a different set of credentials.

29
00:01:47,483 --> 00:01:50,450
And sometimes I want to run it and get the results back immediately

30
00:01:50,483 --> 00:01:53,316
and sometimes I want to run it and then get the results back later.

31
00:01:53,483 --> 00:01:58,216
And sometimes I want to run it in a way that I can do anything

32
00:01:58,483 --> 00:02:00,466
and sometimes I want to run it in an environment where, "No,

33
00:02:01,166 --> 00:02:05,466
no, no, these and only these commands you can run," in secure environments.

34
00:02:05,483 --> 00:02:09,450
And so there's this notion of this universal code execution model.

35
00:02:09,483 --> 00:02:11,466
And, oh, by the way, sorry, the last one was sometimes I want

36
00:02:11,483 --> 00:02:15,316
to run it and I'm going to run it for such a long time that I

37
00:02:15,400 --> 00:02:18,466
might want to like shut down the machine and bring it back up

38
00:02:18,483 --> 00:02:19,466
and have it continue to run.

39
00:02:19,483 --> 00:02:22,466
>> Right, go somewhere else and maybe check on it or something.

40
00:02:22,483 --> 00:02:28,466
>> Exactly. So this is the notion of the universal code execution model.

41
00:02:28,483 --> 00:02:31,466
And remoting, of course, is intrinsic to that. Coupled with

42
00:02:31,483 --> 00:02:33,466
that are notions of jobs...

43
00:02:34,483 --> 00:02:37,466
Jobs are things that run in the background... and then workflow

44
00:02:37,483 --> 00:02:40,466
which we added in PowerShell Version 3 which the idea that says,

45
00:02:40,483 --> 00:02:43,466
hey, I'm going to run this and at any stage after any command

46
00:02:43,483 --> 00:02:48,466
I can suspend things, shut down the machine, bring it back up

47
00:02:48,483 --> 00:02:51,183
and continue from where I started.

48
00:02:51,266 --> 00:02:54,466
>> See, this sounds awesome. Now what we had before is like with

49
00:02:54,483 --> 00:02:57,466
the remote server administration tools, I have a graphical like

50
00:02:57,483 --> 00:03:00,466
I can direct users in computers. It will connect to a domain

51
00:03:00,483 --> 00:03:03,433
controller over DCOM using RPC, right?

52
00:03:03,450 --> 00:03:03,466
>> Yes.

53
00:03:04,483 --> 00:03:07,466
>> And there are a lot of challenges and problems with that: firewall

54
00:03:07,233 --> 00:03:07,466
challenges, right...

55
00:03:08,0 --> 00:03:08,466
>> Yes.

56
00:03:08,483 --> 00:03:13,466
>> ...and all kinds of a mess. But what you guys created, though,

57
00:03:13,483 --> 00:03:15,466
solves all those problems.

58
00:03:15,483 --> 00:03:18,466
>> Exactly. So here's what we did: first, we wanted to solve all

59
00:03:18,483 --> 00:03:22,466
of those problems. So http? Super important. Next was, we already

60
00:03:22,483 --> 00:03:27,466
had a protocol that went over http, our standards-based management.

61
00:03:27,216 --> 00:03:31,183
So you probably heard we talk a lot these days about standards-based management.

62
00:03:31,266 --> 00:03:36,466
In fact, at TechEd's I'll show up and bring up a Linux box and

63
00:03:36,483 --> 00:03:40,366
I'll show on a Linux box I can enumerate all the roles on a remote

64
00:03:40,450 --> 00:03:45,216
Windows Server and then install roles on a remote Windows Server

65
00:03:45,300 --> 00:03:47,466
from a Linux box. Just crazy stuff.

66
00:03:48,466 --> 00:03:50,466
>> I saw you do that demonstration for the first time I think

67
00:03:51,166 --> 00:03:53,466
it was like a year and a half ago and I just went, "Ahh!" >> You

68
00:03:53,483 --> 00:03:54,466
head just explodes.

69
00:03:54,483 --> 00:03:55,466
>> I know.

70
00:03:55,483 --> 00:04:00,466
>> So this is because of this standards and WinRM or WS Management

71
00:04:01,0 --> 00:04:03,466
Protocols; WinRM's are an implementation of that. And so for

72
00:04:03,483 --> 00:04:08,400
PowerShell remoting we leverage WinRM and we added streaming

73
00:04:08,483 --> 00:04:11,466
extensions to it. And that's how it works.

74
00:04:11,483 --> 00:04:14,466
>> And WinRM is the service that you're going to see that's running

75
00:04:14,483 --> 00:04:16,466
underneath all of that. As a matter of fact I've got a couple

76
00:04:16,483 --> 00:04:20,366
of slides here and then, we'll talk some more about this.

77
00:04:20,450 --> 00:04:22,466
If you take a look at the slide here as an overview of remoting,

78
00:04:22,483 --> 00:04:27,466
basically what this comes down to is you can go and touch...

79
00:04:27,483 --> 00:04:30,466
Just as Jeffrey went through the scenarios, using what you've

80
00:04:30,483 --> 00:04:34,466
already been typing in at the console locally, you can pick that

81
00:04:34,483 --> 00:04:38,466
up and now fire that at whatever it is you want to fire it at.

82
00:04:38,233 --> 00:04:42,283
And it's over remoting which is going to give us a lot of cool characteristics.

83
00:04:42,366 --> 00:04:45,466
It's going to be fast. It's going to be easy to cross firewalls

84
00:04:45,483 --> 00:04:47,466
because we only have one port to deal with and we're dealing

85
00:04:47,483 --> 00:04:50,466
with a secured port. So here's the idea: if your machines are

86
00:04:50,483 --> 00:04:54,433
in a domain, this isn't going over just http plain text.

87
00:04:54,450 --> 00:04:54,466
>> No.

88
00:04:54,483 --> 00:04:56,466
>> It's getting all encrypted...

89
00:04:56,183 --> 00:04:56,466
>> All encrypted.

90
00:04:56,483 --> 00:04:57,466
>> ...with Kerberos.

91
00:04:57,483 --> 00:04:58,166
>> Yeah.

92
00:04:58,250 --> 00:05:00,466
>> And then, of course, if you're going across the Internet or

93
00:05:00,483 --> 00:05:03,466
across firewalls and you want to put on SSL or if you even want

94
00:05:04,166 --> 00:05:08,466
to do SSL internally, you can put on SSL if you want that full

95
00:05:08,483 --> 00:05:09,466
encrypted tunnel.

96
00:05:09,483 --> 00:05:11,466
>> Well let's be clear: we'll encrypt it twice.

97
00:05:11,483 --> 00:05:13,466
>> We'll encrypt it twice at that point.

98
00:05:13,483 --> 00:05:14,466
[Laughter]

99
00:05:14,216 --> 00:05:16,466
If you really need it twice encrypted, we'll do it twice.

100
00:05:17,483 --> 00:05:20,466
But here's the idea is that you're hitting whatever machines

101
00:05:20,483 --> 00:05:26,466
you want securely and with what credentials you want and nobody

102
00:05:27,483 --> 00:05:29,466
can read it. Nobody can use a protocol sniffer and sniff out

103
00:05:29,483 --> 00:05:33,466
what's going on. So this is actually really cool stuff. You know,

104
00:05:35,216 --> 00:05:40,466
enabling remoting is definitely one of these things that comes up.

105
00:05:40,483 --> 00:05:45,183
First of all we just need to tell everybody that you have to

106
00:05:45,266 --> 00:05:47,266
remoting on kinda, sorta, maybe.

107
00:05:47,483 --> 00:05:53,333
Kinda, sorta, maybe because in prior versions, not Server 2012

108
00:05:53,483 --> 00:05:55,466
but in prior versions, remoting had to be turned. And this can

109
00:05:55,483 --> 00:05:59,466
actually kind of a hard conversation for some security people

110
00:05:59,216 --> 00:06:02,466
to have or some admins to have with their security people in

111
00:06:02,483 --> 00:06:05,466
that, "I'm going to turn on this really cool thing that lets

112
00:06:05,483 --> 00:06:07,466
me do whatever I want to whenever I want." And the security guy

113
00:06:07,483 --> 00:06:09,466
goes, "No." >> Yeah.

114
00:06:09,483 --> 00:06:12,166
>> Which is exactly what they should say. But as soon as they

115
00:06:12,250 --> 00:06:15,466
understand remoting and how it works all of a sudden it's like,

116
00:06:15,483 --> 00:06:18,466
"Oh, well yeah, this is perfectly fine." >> Yes.

117
00:06:18,233 --> 00:06:21,466
>> So there's this conversation that has to happen to get it turned on.

118
00:06:21,483 --> 00:06:25,466
And if you guys take a look at the slide here, what I've done

119
00:06:25,483 --> 00:06:28,466
is I've shown you a basic way to turn it on. I'm actually going

120
00:06:28,483 --> 00:06:31,466
to demonstrate this on one of my machines here. But there's

121
00:06:31,483 --> 00:06:36,350
a cmdlet that you can use called enable dash PS remoting.

122
00:06:36,433 --> 00:06:40,466
Now if you want to walk around to all of your servers and type

123
00:06:40,483 --> 00:06:44,466
enable PS remoting, knock yourself out. But there's a group

124
00:06:44,483 --> 00:06:48,416
policy and I have it written down here for you; it's much easier

125
00:06:48,483 --> 00:06:51,466
if you use the group policy to enable remoting. But here's the

126
00:06:51,483 --> 00:06:56,466
deal: you have to turn this on. Let me say it again.

127
00:06:57,483 --> 00:07:00,466
You have to turn this on.

128
00:07:02,383 --> 00:07:04,466
We're going to show you all of these great features, but none

129
00:07:04,483 --> 00:07:07,250
of it is going to work until you turn on remoting. It's not

130
00:07:07,333 --> 00:07:10,466
necessarily and easy conversation. There's a free e-book on

131
00:07:10,483 --> 00:07:13,466
PowerShell.org, secrets about remoting.

132
00:07:13,483 --> 00:07:14,466
>> Yeah, great book.

133
00:07:14,483 --> 00:07:18,200
>> Which will not only take you through every possible scenario

134
00:07:18,483 --> 00:07:22,300
but is the information that your security guys need to know so

135
00:07:22,383 --> 00:07:25,466
that they understand that it's secured and what ports it uses.

136
00:07:26,483 --> 00:07:28,466
This has to be turned on.

137
00:07:28,483 --> 00:07:31,466
It's not because I'm just saying it, it's because you're running

138
00:07:31,183 --> 00:07:34,466
out of options now. A lot of the new administrative graphical

139
00:07:34,483 --> 00:07:38,466
tools are made to use PowerShell and PowerShell remoting.

140
00:07:38,483 --> 00:07:42,366
Server 2012 is a great example with the new server manager, right?

141
00:07:42,450 --> 00:07:45,466
It's using all of these capabilities that are built in and if

142
00:07:45,483 --> 00:07:49,466
you don't have it turned on, you can't manage anything with anything.

143
00:07:49,483 --> 00:07:53,466
So you've got to get it turned on. And as a side note, Server

144
00:07:53,483 --> 00:07:56,383
2012: it's turned on by default.

145
00:07:57,483 --> 00:07:59,166
So it's going to get turned on.

146
00:07:59,483 --> 00:08:03,466
>> Just to be clear on that one: so as you know, we are secure

147
00:08:03,483 --> 00:08:07,466
by default and released by release. We continue to shut things

148
00:08:07,483 --> 00:08:10,333
off by default and you have to turn them on.

149
00:08:10,483 --> 00:08:13,466
In the course... This has been going on for quite a number of years.

150
00:08:13,483 --> 00:08:17,350
It's been exactly, to my knowledge, one time where we went the

151
00:08:17,433 --> 00:08:20,466
other direction, where we turned something on by default instead

152
00:08:20,483 --> 00:08:22,466
of off by default. And that was?

153
00:08:23,483 --> 00:08:25,466
>> It's got to be PowerShell remoting.

154
00:08:25,216 --> 00:08:27,466
>> PowerShell remoting. That's right. So for Windows Server 2012

155
00:08:28,166 --> 00:08:32,466
we turned on PowerShell remoting. It was a big issue. The security

156
00:08:32,483 --> 00:08:34,466
guys are like, "What are you talking about? Maybe you didn't

157
00:08:34,483 --> 00:08:37,466
get the memo, we're going the other direction." And it's like,

158
00:08:37,483 --> 00:08:40,466
"Okay, well let's talk about that. Why is that?" And the answer

159
00:08:40,483 --> 00:08:45,466
is of course, Windows Server 2012, right, it is a cloud operating system.

160
00:08:45,483 --> 00:08:48,200
A cloud operating system says, "Hey, it's not about this server,

161
00:08:48,283 --> 00:08:51,450
it's about these servers. I need to be able to manage things."

162
00:08:51,483 --> 00:08:55,466
And, therefore, remoting of large numbers of systems is a critical

163
00:08:55,483 --> 00:08:58,466
function; it is the core of a cloud OS. And so they said, "Okay.

164
00:08:58,483 --> 00:09:02,466
Well, I'm willing to entertain that. That makes sense. But we've

165
00:09:02,483 --> 00:09:04,350
got to be sure." And we said, "Okay, well let's walk through

166
00:09:04,433 --> 00:09:06,383
it." And we showed them all of the things we had done. And actually

167
00:09:06,466 --> 00:09:07,466
they've been involved all along.

168
00:09:08,266 --> 00:09:11,450
And step by step by step we went and did the thread analysis,

169
00:09:11,483 --> 00:09:14,466
and they were convinced, "Yeah, this is safe to do." And so when

170
00:09:14,483 --> 00:09:17,466
you have that conversation with your security guys, you just

171
00:09:17,483 --> 00:09:23,466
point to that, "In the history of this server, one time we switch

172
00:09:23,216 --> 00:09:27,333
and turn things on by default, it is PowerShell remoting." So

173
00:09:27,416 --> 00:09:27,466
go for it.

174
00:09:27,483 --> 00:09:30,183
>> Yeah and I think that's a really great concept because Microsoft

175
00:09:30,266 --> 00:09:34,466
is not going to turn on something that is an easy to use attack service.

176
00:09:34,483 --> 00:09:35,466
It's just not going to happen.

177
00:09:35,483 --> 00:09:39,283
>> Yeah, we put an extraordinary amount into the security of making

178
00:09:39,366 --> 00:09:42,466
sure that this is going to be a secure environment. We've got

179
00:09:42,200 --> 00:09:46,466
pen testers who have been evaluating the design, the code, etcetera.

180
00:09:47,483 --> 00:09:51,466
Yeah, we spent a lot... Look, we started PowerShell after Bill

181
00:09:51,483 --> 00:09:54,433
Gates' famous security...

182
00:09:54,450 --> 00:09:54,466
>> Memo, yeah.

183
00:09:54,483 --> 00:09:58,466
>> Right? And what started that security memo, what started that

184
00:09:58,483 --> 00:09:59,466
whole boof-o-rama?

185
00:10:00,483 --> 00:10:01,466
"I love you." >> I

186
00:10:01,483 --> 00:10:02,183
love you, man.

187
00:10:02,483 --> 00:10:03,366
>> .VBS >> Oh,

188
00:10:03,450 --> 00:10:05,466
you're talking about that. I was just saying I love you, man.

189
00:10:05,483 --> 00:10:06,383
Sorry.

190
00:10:06,483 --> 00:10:08,433
>> Oh, that's special. Okay.

191
00:10:08,450 --> 00:10:08,466
>> Okay.

192
00:10:08,483 --> 00:10:13,183
>> I don't think there's anything wrong with that. No, it was

193
00:10:13,266 --> 00:10:17,200
scripting had caused that big "I love you" mess, and so we knew

194
00:10:17,283 --> 00:10:20,466
that scripting was going to be a key vector. So we just spent

195
00:10:20,483 --> 00:10:24,466
a ton of time making sure we were secure, secure, secure.

196
00:10:25,166 --> 00:10:28,350
>> So now that we've jumped up and down enough that you not only

197
00:10:28,433 --> 00:10:30,466
have to turn this on but it's secured to have it turned on.

198
00:10:30,483 --> 00:10:33,466
Get it turned on. Let's start to show you some of the cool things

199
00:10:33,483 --> 00:10:35,466
that you can do. Now like I said, we're going to hit this topic

200
00:10:35,483 --> 00:10:38,466
twice as we learn more and more about it. So this is all in

201
00:10:38,483 --> 00:10:43,466
the slides but let me take you through here and as soon as I can...

202
00:10:43,483 --> 00:10:44,466
There we go.

203
00:10:47,483 --> 00:10:48,466
Well, maybe not quite.

204
00:10:49,483 --> 00:10:51,250
>> I can do something.

205
00:10:51,483 --> 00:10:53,433
>> I think you have control of my machine.

206
00:10:53,450 --> 00:10:53,466
>> No.

207
00:10:54,333 --> 00:10:54,466
>> No?

208
00:10:54,200 --> 00:10:54,466
>> I gave it up.

209
00:10:54,483 --> 00:10:58,466
>> Okay, my machine is just moving slow for a second. Oh, here

210
00:10:58,483 --> 00:11:01,466
we go. Okay, so let me do something real quick and, Jeffrey,

211
00:11:01,483 --> 00:11:05,466
please jump in. First of all I'm going to do a one-to-one connection.

212
00:11:05,233 --> 00:11:08,333
And you'll see exactly... Watch, I'm just going to type enter...

213
00:11:08,483 --> 00:11:09,166
It's a cmdlet...

214
00:11:09,483 --> 00:11:12,466
PS session... PowerShell session... and I'm going to put in

215
00:11:12,483 --> 00:11:16,183
a computer name that I want to go to. I'm just going to say

216
00:11:16,266 --> 00:11:19,466
DC; it's one of the VM's that have running. Watch what happens

217
00:11:19,483 --> 00:11:22,450
to my prompt here. Did you see what happened?

218
00:11:22,483 --> 00:11:29,300
Guess where I'm sitting right now? Guess where I am right now?

219
00:11:29,383 --> 00:11:34,466
I'm on the DC. I'm on the DC. You don't believe me? Watch, I'm

220
00:11:34,483 --> 00:11:38,466
going to clean up this path a little bit. Watch. Host name

221
00:11:41,483 --> 00:11:45,466
and I'll do IP config. That information is coming from the DC.

222
00:11:45,483 --> 00:11:49,333
So I can actually do a one-to-one connection and I can trouble

223
00:11:49,483 --> 00:11:53,466
shoot and I can manage a single system this way as if I was sitting

224
00:11:53,483 --> 00:11:54,466
on there. As a matter of fact let me...

225
00:11:54,483 --> 00:11:56,466
>> Think of this as a secured telnet.

226
00:11:56,483 --> 00:12:00,466
>> A secured telnet. I love that. And let me show you why I think

227
00:12:01,166 --> 00:12:05,466
that this is also so important that you just get used to managing servers.

228
00:12:05,183 --> 00:12:07,466
When you just need to do one thing to one server, this is a great

229
00:12:07,483 --> 00:12:12,466
way to do it. Get used to this. Have you guys seen Server 2012?

230
00:12:13,166 --> 00:12:16,466
Let me exit out of this and let me just show you. I'm going

231
00:12:16,483 --> 00:12:17,466
to go out to

232
00:12:18,483 --> 00:12:22,466
my domain control and I'm going to show you Server 2012.

233
00:12:22,483 --> 00:12:24,466
This is, to me, fascinating.

234
00:12:27,266 --> 00:12:28,466
Welcome aboard.

235
00:12:28,483 --> 00:12:29,466
>> Oh man, that is...

236
00:12:30,333 --> 00:12:31,466
>> And by the way, what you guys did with the color scheme on

237
00:12:31,483 --> 00:12:32,466
here is just awesome.

238
00:12:32,483 --> 00:12:33,466
>> It is.

239
00:12:33,483 --> 00:12:37,466
>> Yeah, the background, the color scheme. This is totally awesome.

240
00:12:37,483 --> 00:12:39,233
>> It's XEN-like in its simplicity.

241
00:12:39,483 --> 00:12:42,466
>> It's very XEN-like in its simplicity. Yep, you guys probably

242
00:12:42,483 --> 00:12:47,283
figured out that this definitely... We used to refer to this

243
00:12:47,366 --> 00:12:49,466
as the core installation; and, yeah, it was Server 2012.

244
00:12:49,483 --> 00:12:52,333
This is now the default installation.

245
00:12:52,483 --> 00:12:53,466
>> Yes.

246
00:12:53,483 --> 00:12:57,466
>> And for a good reason: performance, security, all that kind

247
00:12:57,483 --> 00:13:02,466
of stuff. So let me show you, you would be managing the server

248
00:13:02,483 --> 00:13:06,466
that way anyways. And I don't want to screw this up so let me

249
00:13:06,483 --> 00:13:07,466
get rid of him.

250
00:13:08,483 --> 00:13:12,466
So doing that single session, that inter-PS session to a machine

251
00:13:12,483 --> 00:13:16,433
that you want to do work on, it gives you that one-to-one connection

252
00:13:16,483 --> 00:13:19,466
and you can now do whatever you want on that machine. But here's

253
00:13:19,483 --> 00:13:22,466
the big one so let me exit this.

254
00:13:23,483 --> 00:13:25,466
You guys have been watching all day long and you know you're

255
00:13:25,483 --> 00:13:28,466
going to be doing a lot of good, hard work on stuff like this.

256
00:13:28,216 --> 00:13:31,466
I want to do get-eventlog log name system,

257
00:13:33,483 --> 00:13:37,333
and I'm just going to do newest 3. Now I could do entry type

258
00:13:37,416 --> 00:13:39,466
and all this other stuff but I just want to keep it short and

259
00:13:39,483 --> 00:13:42,466
simple because let me just show you. I'm going to take this

260
00:13:42,166 --> 00:13:43,350
and I'm going to copy this.

261
00:13:43,483 --> 00:13:47,466
What I can get to work here and what Jeffrey was saying is the

262
00:13:47,483 --> 00:13:51,250
whole point is it'll work anywhere. So here's what I'm going

263
00:13:51,333 --> 00:13:54,466
to: I'm going to invoke-command.

264
00:13:56,483 --> 00:13:58,466
This is a remoting command.

265
00:13:59,483 --> 00:14:05,466
When you use this dash computer name, it's using PowerShell remoting

266
00:14:05,216 --> 00:14:08,466
not the old DCOM RPC stuff which is what a lot of the older cmdlets use.

267
00:14:08,483 --> 00:14:13,466
So this one is using the good stuff. And then, whatever you

268
00:14:13,483 --> 00:14:16,466
put in the squigglies is exactly what we're going to do. Whoops, sorry.

269
00:14:17,0 --> 00:14:19,466
Wait a minute. Put in some computer names and I'm going to be

270
00:14:20,0 --> 00:14:22,466
brave and risky.

271
00:14:23,316 --> 00:14:26,466
Whatever you put in the squigglies is exactly what we're going

272
00:14:26,233 --> 00:14:29,466
to do. And in this case, watch.

273
00:14:32,216 --> 00:14:33,466
So over remoting...

274
00:14:34,400 --> 00:14:36,433
Was that approval back there that we heard?

275
00:14:36,450 --> 00:14:36,466
>> Woo-woo.

276
00:14:36,483 --> 00:14:38,466
>> A knock or something?

277
00:14:39,450 --> 00:14:42,466
I want you to get that what just happened is, is by using PowerShell

278
00:14:42,483 --> 00:14:46,400
remoting I just hit three different systems all at the same time

279
00:14:46,483 --> 00:14:49,466
and said, "Give me this information." I can now convert this.

280
00:14:49,483 --> 00:14:52,283
I can put it to a file. I can put it to a web page, whatever

281
00:14:52,366 --> 00:14:56,466
it is I want to do with it but I just used PowerShell remoting.

282
00:14:56,483 --> 00:15:00,466
And, Jeffrey, this is actually so powerful that admins need to

283
00:15:01,166 --> 00:15:04,466
be a little careful, right, because things like... I don't know.

284
00:15:05,333 --> 00:15:06,466
>> Restart computer.

285
00:15:06,483 --> 00:15:10,466
>> Yeah, that's a good one. Restart computer, all of a sudden

286
00:15:10,483 --> 00:15:14,200
takes on a whole new dimension because whatever you fill that

287
00:15:14,283 --> 00:15:17,466
with, that's what it's going to do. Dash computer name, I could

288
00:15:17,483 --> 00:15:20,466
be grabbing the computers from Active Directory, a CSV file,

289
00:15:20,483 --> 00:15:21,466
a text file.

290
00:15:21,483 --> 00:15:22,466
>> You're making me nervous, man.

291
00:15:22,483 --> 00:15:24,466
>> I know, at the moment I'm actually very nervous too. I need

292
00:15:25,333 --> 00:15:26,466
to get rid of that so it doesn't actually...

293
00:15:26,483 --> 00:15:28,433
>> Why don't you type minus what if.

294
00:15:28,450 --> 00:15:28,466
[Laughter]

295
00:15:28,483 --> 00:15:31,466
>> And so it's going to restart those machines. So this is a

296
00:15:32,166 --> 00:15:34,466
one-to-many connection. Now, Jeffrey, one of the things that

297
00:15:34,483 --> 00:15:38,466
comes up all the time is if I do get-service and I'll do name Bits.

298
00:15:39,483 --> 00:15:42,466
How's this working? It's actually sending the commands to the

299
00:15:42,483 --> 00:15:44,466
machine and then, how am I getting this data back?

300
00:15:44,483 --> 00:15:48,466
>> Yeah, so literally what happens is we go and we create a connection

301
00:15:48,483 --> 00:15:50,350
to that remote machine.

302
00:15:50,483 --> 00:15:56,466
So there's a TCP connection. We then fire up a PowerShell connection.

303
00:15:56,483 --> 00:16:01,466
We load .NET. We load PowerShell. We take that code and we squirt

304
00:16:01,483 --> 00:16:06,466
it across the wire. We then execute it. We logged you in, use

305
00:16:06,483 --> 00:16:09,466
your credentials to log you in. We then execute the code there.

306
00:16:09,483 --> 00:16:14,333
Then, we get those objects and we serialize those objects.

307
00:16:14,483 --> 00:16:18,466
We move them across the wire and then, we reconstitute them;

308
00:16:18,483 --> 00:16:21,466
we deserialize them and emit them as though they happened here.

309
00:16:22,0 --> 00:16:23,466
>> Okay. Okay, so let me see if I can get this straight because

310
00:16:23,483 --> 00:16:25,433
you're going to have to explain the serialization stuff.

311
00:16:25,450 --> 00:16:25,466
>> Yes.

312
00:16:25,483 --> 00:16:27,466
>> But let me see if I can get this straight. So we're connecting

313
00:16:27,483 --> 00:16:31,466
to these remote machines and we're actually starting a PowerShell

314
00:16:31,183 --> 00:16:35,466
session on those machines and having the command run on those machines.

315
00:16:35,483 --> 00:16:38,466
So it's not my computer working harder, it's those machines that

316
00:16:39,0 --> 00:16:39,466
are doing the work.

317
00:16:39,483 --> 00:16:40,466
>> Yep.

318
00:16:40,483 --> 00:16:44,466
>> Now the serialization, you're squirting this stuff back. Serialize, deserialize?

319
00:16:45,483 --> 00:16:47,466
[Sound] What does this mean?

320
00:16:47,483 --> 00:16:52,466
>> Exactly. So what we do is we take the object and we transform

321
00:16:52,483 --> 00:16:56,466
it into something that can be moved around and reconstructed anywhere.

322
00:16:57,450 --> 00:16:57,466
>> Okay.

323
00:16:57,483 --> 00:17:03,183
>> So concretely anywhere. Like, I'm over here... I go talk to

324
00:17:03,266 --> 00:17:06,466
your machine and it's Windows talking .NET. And then, I can

325
00:17:06,183 --> 00:17:08,466
bring it over here and it can be Linux. Now there is no .NET

326
00:17:08,483 --> 00:17:10,466
on Linux so how is that going to work?

327
00:17:10,483 --> 00:17:11,466
>> Right?

328
00:17:11,483 --> 00:17:14,466
>> And so I've got to serialize it into something that can work anywhere.

329
00:17:15,166 --> 00:17:18,466
Now imagine I go and I say, "Well, hey, I talked to Exchange

330
00:17:19,483 --> 00:17:23,466
version whatever and I get the objects here, but I don't have

331
00:17:23,483 --> 00:17:26,466
Exchange here." So how do I recreate Exchange objects?

332
00:17:27,450 --> 00:17:27,466
>> Right?

333
00:17:27,483 --> 00:17:30,466
>> Again, that's the problem. So what we do is we take these objects

334
00:17:30,483 --> 00:17:34,216
and we turn them into essentially a property bag. Now it's just

335
00:17:34,300 --> 00:17:37,466
a bag of properties. And then we take them... You know, the

336
00:17:37,483 --> 00:17:41,466
properties have names and values and the values have types.

337
00:17:41,483 --> 00:17:46,466
Now here's the trick: the types are not the infinite set of types there.

338
00:17:46,483 --> 00:17:50,466
If you tried to do that it would never work. So what we do is

339
00:17:50,216 --> 00:17:53,466
we render it down to a set of, I think, 26 or so types.

340
00:17:53,483 --> 00:17:57,466
Which, you know, I put my badge on the table and I say, "I guarantee

341
00:17:57,483 --> 00:18:01,433
that these will always work. If these don't work, fire me." >> Well,

342
00:18:01,450 --> 00:18:01,466
there you go.

343
00:18:01,483 --> 00:18:04,466
>> Forever. Forever. Because you know what?

344
00:18:04,483 --> 00:18:07,466
An Exchange

345
00:18:09,483 --> 00:18:12,283
mailbox, 30 years from now, probably going to change. But I

346
00:18:12,366 --> 00:18:14,466
guarantee you this, a 64-bit integer isn't going to change...

347
00:18:14,483 --> 00:18:15,450
>> Isn't going to change.

348
00:18:15,483 --> 00:18:16,466
>> ...30 years from now.

349
00:18:16,200 --> 00:18:16,466
>> Yeah.

350
00:18:16,483 --> 00:18:20,466
>> So it's those types of things: integers, strings, int's, GUID's,

351
00:18:20,483 --> 00:18:22,450
things like that.

352
00:18:22,483 --> 00:18:23,300
>> Oh, okay, yeah. GUID's. Things that are...

353
00:18:23,383 --> 00:18:24,183
>> Secure strings.

354
00:18:24,266 --> 00:18:25,466
>> ...going to be the same.

355
00:18:25,483 --> 00:18:29,466
>> Exactly. So then I take that property bag and I just turn it

356
00:18:29,483 --> 00:18:33,233
into XML. I then bring it over here and then I reconstruct the

357
00:18:33,316 --> 00:18:33,466
property bag.

358
00:18:34,483 --> 00:18:38,300
By the way, let me correct something.

359
00:18:38,383 --> 00:18:38,466
>> Sure.

360
00:18:38,483 --> 00:18:39,466
>> Show your screen.

361
00:18:39,483 --> 00:18:40,466
>> Okay.

362
00:18:40,233 --> 00:18:43,466
>> Okay. So you said that this was remoting. In fact, invoke

363
00:18:43,483 --> 00:18:45,466
command is not remoting.

364
00:18:45,483 --> 00:18:46,466
>> Oh, what is it?

365
00:18:46,483 --> 00:18:49,466
>> Remote command is the way we do everything. Remember we have

366
00:18:49,483 --> 00:18:51,433
this kind of underlying system...

367
00:18:51,450 --> 00:18:51,466
>> Oh, yeah. Yeah, yeah.

368
00:18:51,483 --> 00:18:52,466
>> And then, we've got...

369
00:18:52,483 --> 00:18:53,466
>> Great definition.

370
00:18:54,433 --> 00:18:58,466
>> ...syntactic sugar on top of it. So go remove the minus computer name.

371
00:18:59,483 --> 00:19:00,466
>> So let's do this.

372
00:19:01,483 --> 00:19:04,366
>> Well that whole DC 123.

373
00:19:05,166 --> 00:19:09,466
DC, yeah. Get rid of that. Okay, and hit carriage return.

374
00:19:09,183 --> 00:19:14,416
Okay, so that worked locally and that's the same as if you hadn't

375
00:19:14,483 --> 00:19:18,216
typed invoke command and squiggle brackets. Or rather, say when

376
00:19:18,300 --> 00:19:22,466
you just type get-service minus name Bits, we transform it into

377
00:19:22,483 --> 00:19:24,466
this and then we run it.

378
00:19:24,483 --> 00:19:25,450
>> And then we run it.

379
00:19:25,483 --> 00:19:26,466
>> This is the universal code...

380
00:19:26,483 --> 00:19:27,466
>> Universal code.

381
00:19:28,166 --> 00:19:28,466
>> ...execution.

382
00:19:28,483 --> 00:19:33,466
>> And this is what makes it so easy especially if you're an administrator

383
00:19:33,483 --> 00:19:38,466
you work out what you want first then you can just put it in

384
00:19:38,483 --> 00:19:41,466
the squigglies and it's going to work at the other side.

385
00:19:41,483 --> 00:19:44,466
>> So from here, pipe that to get-member.

386
00:19:48,0 --> 00:19:49,466
Okay, scroll up.

387
00:19:51,483 --> 00:19:52,466
And what do we have?

388
00:19:52,483 --> 00:19:53,466
>> Service controller...

389
00:19:53,483 --> 00:19:56,466
>> No, look at the beginning. System.

390
00:19:56,483 --> 00:19:57,466
>> System.

391
00:19:57,483 --> 00:20:01,466
>> That's service process; that's service controller. Now add

392
00:20:01,483 --> 00:20:03,466
a computer name to that line.

393
00:20:04,483 --> 00:20:09,466
>> Oh, yeah. So let's do this. Let's have it go to dash... and S1.

394
00:20:11,366 --> 00:20:13,466
>> DC1. Okay, S1. Yeah, whatever.

395
00:20:14,483 --> 00:20:17,466
Now go up. Look at the beginning.

396
00:20:17,483 --> 00:20:18,466
>> Deserialized.

397
00:20:18,483 --> 00:20:22,466
>> It's deserialized. Ding, ding, ding, ding, ding. Now a deserialized

398
00:20:22,483 --> 00:20:26,466
object is incredibly powerful but it's different. So if you

399
00:20:26,483 --> 00:20:27,466
scroll up a bit.

400
00:20:28,483 --> 00:20:29,466
>> Oh, I'm scrolled up all the way.

401
00:20:29,483 --> 00:20:31,466
>> Did you do a clear?

402
00:20:32,483 --> 00:20:33,333
You didn't clear.

403
00:20:33,450 --> 00:20:33,466
>> No, I did a clear.

404
00:20:35,483 --> 00:20:38,466
>> Don't do clear and do it again. Do the local command.

405
00:20:41,483 --> 00:20:43,466
Notice... See these methods.

406
00:20:43,483 --> 00:20:44,383
>> Right.

407
00:20:44,466 --> 00:20:45,466
>> See the start and the stop method?

408
00:20:46,333 --> 00:20:46,466
>> See the stop, yeah.

409
00:20:46,483 --> 00:20:50,466
>> Okay, that's because it's a live object and you can do methods

410
00:20:50,483 --> 00:20:53,466
on it. Go up to the deserialized one.

411
00:20:53,483 --> 00:20:54,466
>> Yeah, it's...

412
00:20:54,483 --> 00:20:56,466
>> Yeah, there's just one method. Two strings.

413
00:20:57,450 --> 00:20:57,466
>> There's one method, two strings.

414
00:20:57,483 --> 00:21:01,466
>> Exactly. Because the object itself is gone and what you have

415
00:21:01,483 --> 00:21:05,466
is representation of the object. Now it turns out that that

416
00:21:05,483 --> 00:21:08,466
is extraordinarily powerful. Now some people say, "Oh, well it

417
00:21:08,483 --> 00:21:11,183
should be the same everywhere." No, no, no, no, my friends, it

418
00:21:11,266 --> 00:21:15,466
should be. The point is that because we have this live

419
00:21:16,483 --> 00:21:20,466
deserialized concept, what it means is that when I've over there

420
00:21:20,483 --> 00:21:24,466
I'm able to take advantage of the remote. I'm able to take advantage

421
00:21:24,483 --> 00:21:28,316
of the full richness of the object system. Be able to do everything

422
00:21:28,400 --> 00:21:32,400
in a very light-weight way, very high performance, low latency

423
00:21:32,483 --> 00:21:36,200
way and then, when I bring it over here I can still do a ton

424
00:21:36,283 --> 00:21:40,466
of stuff but I can't do that. So the way we refer to this is

425
00:21:40,483 --> 00:21:45,233
islands of optimization in a sea of interoperability.

426
00:21:45,483 --> 00:21:49,466
>> Okay, islands of optimization in a sea...

427
00:21:49,483 --> 00:21:50,466
>> Of interoperability.

428
00:21:50,483 --> 00:21:54,466
>> Of interoperability. Which is to say it's poetic.

429
00:21:54,483 --> 00:21:55,466
[Laughter] >> It's poetic.

430
00:21:56,200 --> 00:21:59,466
>> So that means I can go to any of the machines and I can interoperate.

431
00:21:59,483 --> 00:22:02,466
I'm guaranteed to do that. And then there are times, however,

432
00:22:02,483 --> 00:22:07,433
when I'm doing all of the code on one machine that I can optimize.

433
00:22:07,483 --> 00:22:10,300
I have the live objects, I can do things, etcetera. And that,

434
00:22:10,383 --> 00:22:13,466
by the way is what allows us to do the layering GUI's on top

435
00:22:13,483 --> 00:22:21,466
of PowerShell because we have these nice high speed, low latency activities.

436
00:22:21,483 --> 00:22:25,466
If you tried to layer everything on top of a deserialized object,

437
00:22:25,483 --> 00:22:29,466
you know, you've got a lot of recreating objects, a lot of inefficiency.

438
00:22:30,283 --> 00:22:30,466
>> Right, right.

439
00:22:31,166 --> 00:22:31,266
>> Yeah.

440
00:22:31,350 --> 00:22:37,466
>> Well, guys, this is our first hit into remoting. So we did one-to-one.

441
00:22:37,216 --> 00:22:40,466
We did one-to-many. Now we've got more remoting to do because

442
00:22:41,483 --> 00:22:44,466
we're just getting started with the remoting, but now it's getting

443
00:22:44,483 --> 00:22:49,466
to that time for us to... Oh, you know, before we get into scripting,

444
00:22:50,0 --> 00:22:50,466
I just...

445
00:22:50,483 --> 00:22:51,466
>> Oh no, we've got to show more here.

446
00:22:51,483 --> 00:22:54,466
>> Yeah, I know. There's a problem I have.

447
00:22:55,483 --> 00:22:56,466
This is cool but...

448
00:22:57,483 --> 00:22:58,466
You know one of the problems I have?

449
00:22:58,483 --> 00:23:01,466
>> I know a few of the problems you have.

450
00:23:02,166 --> 00:23:03,166
[Laughter]

451
00:23:03,483 --> 00:23:05,166
>> One of the things I run into is

452
00:23:06,483 --> 00:23:08,466
wouldn't it be cool if...

453
00:23:09,483 --> 00:23:12,333
You know, when I go on vacation I don't know about you but I

454
00:23:12,483 --> 00:23:13,466
like to go to places with beaches.

455
00:23:13,483 --> 00:23:14,466
>> Oh yeah. Oh yeah.

456
00:23:14,483 --> 00:23:18,466
>> That have the little drinks with the little umbrellas in them.

457
00:23:18,483 --> 00:23:21,466
When I'm sitting on the beach, the last thing that I'm going

458
00:23:21,483 --> 00:23:22,466
to have is a laptop.

459
00:23:22,483 --> 00:23:23,466
>> Yeah, right. Not so much.

460
00:23:23,483 --> 00:23:28,466
>> I mean not cool. Not cool at all. But things still go wrong

461
00:23:28,483 --> 00:23:33,266
back at the office. And so, I am going to have a phone.

462
00:23:33,350 --> 00:23:36,466
>> Ah, I see where you're going.

463
00:23:38,483 --> 00:23:44,166
>> You know, it'd be so cool if I could maybe have PowerShell

464
00:23:44,483 --> 00:23:49,433
here and I could launch a script which we're going to be doing

465
00:23:49,483 --> 00:23:52,416
this afternoon or I could type in these commands and I could

466
00:23:52,483 --> 00:23:57,466
do all of this kind of cool stuff. It'd be so cool if I had

467
00:23:57,483 --> 00:23:59,466
PowerShell here or on a tablet...

468
00:23:59,483 --> 00:24:02,466
>> If only you had PowerShell Version 3.

469
00:24:02,483 --> 00:24:06,466
>> If only you had PowerShell Version 3 and at least one

470
00:24:07,483 --> 00:24:11,433
Server 2012 box. It could be a VM, but I want to show you something

471
00:24:11,450 --> 00:24:11,466
kind cool.

472
00:24:12,166 --> 00:24:14,250
>> Have you picked up on the fact that we're big fans of PowerShell

473
00:24:14,333 --> 00:24:14,466
Version 3?

474
00:24:14,483 --> 00:24:18,466
>> Yeah, were huge fans of PowerShell V3. So, guys, I want you

475
00:24:18,483 --> 00:24:20,466
to watch something. I'm actually going to take you through...

476
00:24:20,483 --> 00:24:22,466
This is kind of a cute review... not a cute review. I can't

477
00:24:22,483 --> 00:24:25,466
believe I said the word cute. This is a review. Over what?

478
00:24:25,483 --> 00:24:29,466
We started off with today discovering and utilizing cmdlets and

479
00:24:29,483 --> 00:24:33,466
in this case using a feature that I just think is wickedly awesome.

480
00:24:33,483 --> 00:24:38,450
So here's what I'm going to do. I'm going to enter a PS session

481
00:24:38,483 --> 00:24:42,183
to a server I have out there called PWA. Now this server doesn't

482
00:24:42,266 --> 00:24:46,466
really have anything on it. It's just a generic Server 2012 box.

483
00:24:46,483 --> 00:24:51,416
Key is, 2012. It can be a VM somewhere but it's got to be 2012.

484
00:24:51,483 --> 00:24:55,466
What I'm going to do is there's a cmdlet out there called get-WindowsFeature.

485
00:24:57,233 --> 00:24:59,466
Get-WindowsFeature is part of the server manager module.

486
00:25:00,483 --> 00:25:04,466
What it does is it lists for you all of your roles and features

487
00:25:04,233 --> 00:25:06,433
for your server. And if there are X's in it...

488
00:25:06,450 --> 00:25:06,466
>> Oooh.

489
00:25:06,483 --> 00:25:09,466
>> Yeah, I know. Oooh, I love it. If there's an X, that means

490
00:25:09,483 --> 00:25:13,0
it is installed. If there's not an X, it's not installed.

491
00:25:13,483 --> 00:25:15,466
Well, I'm going to use this cmdlet to see

492
00:25:17,483 --> 00:25:18,466
what features

493
00:25:20,400 --> 00:25:24,466
are available for PowerShell. And in Server 2012 we have something

494
00:25:24,483 --> 00:25:28,466
down here at the bottom called PowerShell Web Access. I'm about

495
00:25:28,483 --> 00:25:30,466
to change the way...

496
00:25:30,483 --> 00:25:32,466
>> The world as we know it.

497
00:25:32,483 --> 00:25:35,466
>> And it's not me. The only thing that I'm changing is I'm showing

498
00:25:35,483 --> 00:25:38,466
you how to set it up. You're the one that changed the world.

499
00:25:38,483 --> 00:25:40,250
>> Well, the team. The team. The team.

500
00:25:40,333 --> 00:25:41,466
>> So, yeah, the team. The team.

501
00:25:42,483 --> 00:25:45,466
So it's called Windows PowerShell Web Access, and this is pretty cool.

502
00:25:45,483 --> 00:25:50,466
So I want to install this. So we have this install Windows feature

503
00:25:50,483 --> 00:25:52,466
cmdlet that'll let me install Windows

504
00:25:54,483 --> 00:25:56,466
PowerShell Web Access.

505
00:25:57,350 --> 00:26:01,333
I've used get-help. The install Windows feature will let me choose

506
00:26:01,416 --> 00:26:03,466
whatever thing I want to install and away it goes. Now here's

507
00:26:04,0 --> 00:26:05,466
what it's going to do.

508
00:26:07,150 --> 00:26:07,166
>> Oooh.

509
00:26:07,250 --> 00:26:11,466
>> Oooh. It's going to install IIS because this is going to be

510
00:26:11,483 --> 00:26:15,466
a web thing. So it's going to install IIS. We have .NET 4.5

511
00:26:15,483 --> 00:26:17,466
on here and it's Server 2012.

512
00:26:18,483 --> 00:26:22,466
When it gets this installed, we'll also get a new module with

513
00:26:22,483 --> 00:26:25,466
some additional cmdlets, six additional cmdlets. So what we're

514
00:26:25,483 --> 00:26:29,466
going to do is use get-help to find them and then use them.

515
00:26:29,483 --> 00:26:32,466
Because in like three steps, I'm going to have one of the coolest

516
00:26:32,483 --> 00:26:35,466
features in the world turned on. So watch. I'm going to clear

517
00:26:35,483 --> 00:26:37,466
my screen. This is just to let me know that I have my updates

518
00:26:37,483 --> 00:26:41,466
turned off which it's a VM; right now it does. But it exited

519
00:26:41,483 --> 00:26:43,466
with success. No restart needed.

520
00:26:43,216 --> 00:26:47,266
Awesome. So clear my screen. And, guys, notice, I'm doing this

521
00:26:47,350 --> 00:26:48,466
all on a different server, right?

522
00:26:48,483 --> 00:26:50,466
>> How cool is that?

523
00:26:50,183 --> 00:26:53,466
>> Yeah, I know. That's totally, wickedly cool. So I'm going

524
00:26:53,483 --> 00:26:54,466
to do get-help.

525
00:26:54,483 --> 00:26:55,466
>> This is not your dad's server.

526
00:26:55,483 --> 00:27:00,466
>> This is not your daddy's server. I love that. So it's called

527
00:27:00,483 --> 00:27:04,466
PowerShell Web Access so PSWA. A lot of us just refer to it as

528
00:27:04,483 --> 00:27:08,466
PWA, PowerShell Web Access. But PSWA. And you're going to see

529
00:27:08,483 --> 00:27:11,250
that there are six cmdlets. By looking at the verbs you could

530
00:27:11,333 --> 00:27:15,383
probably figure out the first place I'm going to go is to install

531
00:27:15,483 --> 00:27:19,316
a PowerShell Web Access application. Technically what's going

532
00:27:19,400 --> 00:27:24,466
to happen is we're going to create a web application by default

533
00:27:24,483 --> 00:27:28,466
off of the default web site when we installed IIS. Now we didn't

534
00:27:28,483 --> 00:27:32,466
need to install it; that happened for us automatically. You can

535
00:27:32,483 --> 00:27:35,466
alter these defaults but I'm just going to take the defaults

536
00:27:35,483 --> 00:27:36,233
for right now.

537
00:27:36,483 --> 00:27:41,466
Now install PWSA. And I'm going to...

538
00:27:41,483 --> 00:27:45,466
You've got to use HTTPS for this because this is going to be

539
00:27:45,483 --> 00:27:50,466
something that you hit from anywhere in the world back to your home.

540
00:27:51,483 --> 00:27:54,466
So we're going to need HTTPS. You can't do this with HTTP.

541
00:27:54,483 --> 00:27:58,466
Now and if you don't have a good certificate to put on your web

542
00:27:58,483 --> 00:28:03,383
box right now, for testing purposes they have this option of

543
00:28:03,466 --> 00:28:06,466
use a test certificate. Now my screen freaked out a little bit,

544
00:28:06,483 --> 00:28:09,466
but use a test certificate. It's going to put on a temporary cert.

545
00:28:09,483 --> 00:28:13,466
Just remember this is not the cert that you want when you go

546
00:28:13,483 --> 00:28:18,383
to production. So what's going to happen is, is that it creates

547
00:28:18,466 --> 00:28:21,466
in IIS terms an application pool for the web app, creates the

548
00:28:21,483 --> 00:28:25,466
web app, points the web app to where the files are and we're

549
00:28:25,216 --> 00:28:26,466
almost ready to go.

550
00:28:27,483 --> 00:28:31,466
We just now have to tell it who's allowed to use this. Now this

551
00:28:31,483 --> 00:28:35,466
is going to be one of those rare do as I say not as I do.

552
00:28:35,483 --> 00:28:38,466
And let me tell you why because I'm going to do get-help again

553
00:28:38,483 --> 00:28:40,466
on PSWA.

554
00:28:41,483 --> 00:28:45,466
We need to create who's allowed to use this and what they're

555
00:28:45,483 --> 00:28:48,466
allowed to go to when they use this.

556
00:28:48,483 --> 00:28:51,466
So we need to add rules, and you're going to want to add granular

557
00:28:51,483 --> 00:28:55,466
rules that make sense. In other words, is there a group of administrators

558
00:28:55,483 --> 00:29:00,466
that you want to be able to have PowerShell Web Access and what

559
00:29:00,483 --> 00:29:04,466
machines should they be allowed to get to or remote to when they

560
00:29:04,483 --> 00:29:08,466
use this. You're going to want to keep control on this.

561
00:29:08,483 --> 00:29:10,466
You're not going to want to do what I'm going to do just for

562
00:29:10,483 --> 00:29:14,466
easy sake. So let me show you what you're looking for here.

563
00:29:14,183 --> 00:29:15,166
So add

564
00:29:16,483 --> 00:29:21,466
PSWA authorization rule. And let me just show you,

565
00:29:22,483 --> 00:29:26,316
what computers do you want to be able to remote to? So you can

566
00:29:26,400 --> 00:29:28,466
make this list. You can create it as a computer group. You also

567
00:29:29,483 --> 00:29:33,416
have another parameter you're going to need is either by user

568
00:29:33,483 --> 00:29:36,466
group or user name, who's allowed to use this. So you going

569
00:29:36,483 --> 00:29:40,466
to want to fill out the user name, what computer and we're not

570
00:29:40,483 --> 00:29:41,466
going to get a chance to do

571
00:29:42,483 --> 00:29:47,466
different kinds of configurations but you can control through

572
00:29:47,200 --> 00:29:49,466
different configurations what cmdlets a person is allowed to

573
00:29:49,483 --> 00:29:53,466
use when they get there which is actually totally cool.

574
00:29:53,483 --> 00:29:55,466
These three things, you need to specify.

575
00:29:55,483 --> 00:29:58,466
>> Just to be clear, that's for things like, "Hey, I'm going to

576
00:29:58,483 --> 00:30:02,466
let these people come into these machines and all they can do

577
00:30:02,483 --> 00:30:06,466
is read-only operations." Like they can do gets but they can't

578
00:30:06,483 --> 00:30:11,466
do sets. And then, this guy on these machines he can reboot the

579
00:30:11,483 --> 00:30:15,216
machine, okay, but he can't read data things like that.

580
00:30:15,300 --> 00:30:18,466
>> And that's a really important point: these users, I've got

581
00:30:18,483 --> 00:30:21,466
administrators that have full capabilities but I've got a guy

582
00:30:21,483 --> 00:30:24,466
who is allowed to reset passwords when we gets there, that kind

583
00:30:24,483 --> 00:30:28,350
of stuff that you can control. Don't do what I'm about to do

584
00:30:28,433 --> 00:30:30,466
in real life. If you're just testing out a VM, that's fine.

585
00:30:30,483 --> 00:30:33,333
But what I'm going to do is for those three parameters, I'm going

586
00:30:33,416 --> 00:30:35,166
to do star, star, star.

587
00:30:35,183 --> 00:30:36,466
[Laughter]

588
00:30:36,483 --> 00:30:39,466
Yeah, I know that means everybody can do everything to everybody

589
00:30:39,483 --> 00:30:40,466
and it's just,

590
00:30:42,316 --> 00:30:45,466
yeah, not cool. But for demonstration purposes...

591
00:30:45,483 --> 00:30:46,466
>> Summer of love.

592
00:30:46,483 --> 00:30:53,366
>> The summer of love. At this point I installed the feature,

593
00:30:54,450 --> 00:30:58,466
I installed the web app and I have not created a rule.

594
00:31:00,400 --> 00:31:00,466
>> Anarchy.

595
00:31:01,483 --> 00:31:05,466
>> Anarchy. This is so freaky cool, guys.

596
00:31:05,483 --> 00:31:06,200
>> Yeah.

597
00:31:06,283 --> 00:31:10,466
>> Let me exit out of that machine. This is so freaky cool that

598
00:31:10,483 --> 00:31:14,466
I'm going to... This is start process. I'm going to use start

599
00:31:14,483 --> 00:31:19,466
and I'm going to start iexplore with HTTPS and I'm going to go

600
00:31:19,483 --> 00:31:23,300
to that PowerShell Web Access box, the box I just set up,

601
00:31:24,483 --> 00:31:29,466
PWA, and it's going to do the default web site. And there's

602
00:31:29,483 --> 00:31:34,466
a web application underneath the default called PSWA. You can

603
00:31:34,483 --> 00:31:37,466
of course alter all of this to make it cleaner, but watch what happens.

604
00:31:38,483 --> 00:31:42,266
Secured site. As a matter of fact, let me make this just a little

605
00:31:42,350 --> 00:31:43,466
bit zoomier.

606
00:31:43,483 --> 00:31:44,466
>> Zoomier.

607
00:31:45,183 --> 00:31:48,383
>> Zoomier. So this is the temporary certificate. Remember in

608
00:31:48,466 --> 00:31:50,466
real life when you go to production, you're going to replace this.

609
00:31:51,333 --> 00:31:52,216
Continue to web site.

610
00:31:53,483 --> 00:31:54,466
It's going to come up; it's going to ask me. Oh, lookie.

611
00:31:55,483 --> 00:31:57,266
It's going to ask for some credentials. So let's do this.

612
00:31:57,350 --> 00:31:59,466
>> Doesn't it look like Outlook web access?

613
00:32:00,483 --> 00:32:02,466
>> Yeah, we need to talk about that.

614
00:32:03,483 --> 00:32:06,233
So here I'm going to put in my credentials.

615
00:32:07,483 --> 00:32:11,466
And what computer do I want to remote to and work with?

616
00:32:11,483 --> 00:32:13,466
Well, let's go mess with the domain controller; I feel kind of

617
00:32:13,483 --> 00:32:14,466
froggy today.

618
00:32:16,483 --> 00:32:17,466
Get it.

619
00:32:17,483 --> 00:32:20,466
>> Oh, do a host name. Do a host name. Show them where we are.

620
00:32:20,483 --> 00:32:25,166
>> Oh, this is so cool. It's PowerShell through a browser.

621
00:32:26,483 --> 00:32:31,466
It's PowerShell through... You made PowerShell work through...

622
00:32:31,483 --> 00:32:33,466
But, guys, gals...

623
00:32:34,166 --> 00:32:34,466
>> On the beach.

624
00:32:35,483 --> 00:32:37,466
>> On the beach through any browser.

625
00:32:38,0 --> 00:32:38,250
>> Any.

626
00:32:38,333 --> 00:32:39,466
>> It's funny that

627
00:32:41,483 --> 00:32:46,283
it can be Safari. It can be IE. It can be Chrome. It can be

628
00:32:46,366 --> 00:32:50,200
on any device, a Microsoft device, a non-Microsoft device, your

629
00:32:50,283 --> 00:32:54,466
phone, your tablet, your laptop, anywhere in the world, you've

630
00:32:54,483 --> 00:32:57,466
got PowerShell. And I want to point out that not all of these

631
00:32:57,483 --> 00:32:59,466
things have tab buttons when you use them.

632
00:33:00,483 --> 00:33:03,466
But, look, I'll just even type a get-serve...

633
00:33:05,483 --> 00:33:09,433
Lookie, they gave you a tab completion button.

634
00:33:10,483 --> 00:33:14,466
I mean, come on. They thought this through. This is so totally awesome.

635
00:33:14,483 --> 00:33:17,466
Now a lot of you right now are going, "Wait a minute. Wait a minute.

636
00:33:17,200 --> 00:33:20,200
Wait a minute. Wait a minute. Wait a minute. What about security?"

637
00:33:21,200 --> 00:33:25,350
Stop it. It's just like getting your e-mail. It's the same thing

638
00:33:25,433 --> 00:33:28,466
as getting your e-mail. If you have Exchange, you've got a CAS-Role

639
00:33:28,483 --> 00:33:31,466
out there probably in your middle tier or protected by Threat

640
00:33:31,483 --> 00:33:34,466
Management Gateway, whatever you have, it's the same thing.

641
00:33:34,483 --> 00:33:38,466
You can put the box right next to it. It's the same thing.

642
00:33:38,483 --> 00:33:42,466
So everybody says, "Well, this is going to be dangerous." No

643
00:33:42,183 --> 00:33:45,466
more dangerous than you checking your e-mail. It's over HTTPS.

644
00:33:45,483 --> 00:33:48,466
You control who has access to this. You can even control what

645
00:33:48,483 --> 00:33:50,466
cmdlets they can run.

646
00:33:51,183 --> 00:33:55,466
This is one of the best tools. And for a guy like me that's traveling

647
00:33:55,483 --> 00:33:56,466
all over the place,

648
00:33:57,483 --> 00:34:01,466
I don't have a laptop necessarily with VPN to my network all

649
00:34:01,483 --> 00:34:04,183
the time. Sometimes the only thing I have is the tablet in my

650
00:34:04,266 --> 00:34:07,466
hand and I can run scripts... Which we need to do scripts...

651
00:34:08,483 --> 00:34:11,466
and I can have access to PowerShell and remote to any box that

652
00:34:11,483 --> 00:34:12,400
I want to remote to.

653
00:34:12,416 --> 00:34:12,433
>> Dude, you've undersold it.

654
00:34:12,450 --> 00:34:12,466
[Laughter]

655
00:34:12,483 --> 00:34:13,466
>> I've sold it.

656
00:34:15,483 --> 00:34:17,466
>> Undersold it.

657
00:34:17,483 --> 00:34:18,466
>> I've undersold it?

658
00:34:18,483 --> 00:34:22,466
>> The security. Yeah, absolutely. No, this is more secure than that.

659
00:34:22,216 --> 00:34:25,466
Okay, why? So let's see what we're comparing ourselves against.

660
00:34:25,483 --> 00:34:29,466
So there you are and you've got your laptop and you connect to

661
00:34:29,200 --> 00:34:33,466
your domain controller versus you're on your phone or this device

662
00:34:33,483 --> 00:34:34,466
or that device. And you go

663
00:34:35,483 --> 00:34:40,466
HTTPS to a browser or to a web site that then goes and talks

664
00:34:40,483 --> 00:34:44,466
to the domain controller, okay? Now on that machine, that web

665
00:34:44,483 --> 00:34:47,466
server, you're not setting that up so that people are surfing

666
00:34:48,483 --> 00:34:51,466
the net, that web server that you go to. On your laptop you're

667
00:34:51,483 --> 00:34:54,466
off there surfing your net. You're at this new site, that new

668
00:34:54,483 --> 00:34:57,466
site, maybe some dodgy sites.

669
00:34:57,483 --> 00:34:58,466
>> Dodgy sites?

670
00:34:58,483 --> 00:35:02,466
>> Yeah. You're reading your e-mail and people are saying, "Oh,

671
00:35:02,166 --> 00:35:04,466
click here for something wonderful." >> Yeah.

672
00:35:04,483 --> 00:35:09,200
>> And so the risk of using that same box to manage your domain

673
00:35:09,283 --> 00:35:09,466
controller is...

674
00:35:09,483 --> 00:35:10,466
>> Oh, yeah.

675
00:35:10,483 --> 00:35:11,200
>> ...is pretty dodgy.

676
00:35:11,483 --> 00:35:14,466
>> And so that's why the professional sites, they set these things

677
00:35:14,483 --> 00:35:17,466
up called Jump Boxes. What they said is, "Okay, look, take your

678
00:35:17,483 --> 00:35:22,466
dodgy device, whatever, and then you go to this machine." Now

679
00:35:22,483 --> 00:35:25,466
this environment is safe, safe, safe. You get to do one thing

680
00:35:26,166 --> 00:35:29,466
on this environment and that is go to these other environments.

681
00:35:29,166 --> 00:35:31,466
>> And, you know, I think that that is such a great description

682
00:35:31,483 --> 00:35:34,466
because a lot of you guys probably have... you might refer to

683
00:35:34,483 --> 00:35:35,466
them as Bastion boxes.

684
00:35:36,483 --> 00:35:37,466
>> Bastion servers, yeah.

685
00:35:37,216 --> 00:35:40,466
>> Bastion servers where that's the whole point is that my laptop

686
00:35:40,483 --> 00:35:44,433
might be the wrong tool to be managing Active Directory with

687
00:35:44,483 --> 00:35:47,466
because of all of the weird things on it. But this is a controlled

688
00:35:47,483 --> 00:35:50,466
server, a controlled point that I'm going to that isn't going

689
00:35:50,483 --> 00:35:54,466
to have all the garbage and viruses and worms and crap on it.

690
00:35:54,483 --> 00:35:58,300
And this becomes your Bastion point or your Bastion server.

691
00:35:58,383 --> 00:36:02,466
This is awesome. This is a huge time saver, anywhere in the world.

692
00:36:02,483 --> 00:36:05,466
And this is why... I heard this from Microsoft I think it was

693
00:36:05,483 --> 00:36:08,466
in the year 2001, "We want to get to a place to where we can

694
00:36:09,483 --> 00:36:13,466
be anywhere, anytime on any device," I think was the phrase.

695
00:36:13,483 --> 00:36:17,466
And when this feature came out it was, "I can do PowerShell anywhere,

696
00:36:17,483 --> 00:36:22,466
anytime, any device. You win." So awesome feature. Before we

697
00:36:22,483 --> 00:36:25,466
wrap up remoting... Now we're going to do sessions in a little bit.

698
00:36:25,483 --> 00:36:30,466
>> Okay. I think there was a key point we didn't nail. You got

699
00:36:30,483 --> 00:36:31,466
the remoting, man.

700
00:36:32,483 --> 00:36:35,250
>> What would you like to do? Let's leave this page.

701
00:36:35,333 --> 00:36:40,466
>> Yeah. Okay, so go back to where you did the get-event log.

702
00:36:40,483 --> 00:36:43,200
>> Okay. So you just want the get-event log?

703
00:36:43,283 --> 00:36:43,466
>> Invoke command.

704
00:36:43,483 --> 00:36:44,466
>> Invoke command.

705
00:36:44,183 --> 00:36:44,466
>> Yeah, on the three...

706
00:36:44,483 --> 00:36:45,300
>> Okay, invoke command.

707
00:36:45,383 --> 00:36:48,383
>> ...machines. Oh, you're going to do it all over. Computer name.

708
00:36:48,466 --> 00:36:51,466
Oh, wait. If you want, you can just type CN. But anyway, that's fine.

709
00:36:51,483 --> 00:36:54,266
Get-event log.

710
00:36:54,350 --> 00:36:56,450
>> So, yeah. Get-event log.

711
00:36:57,416 --> 00:36:59,466
Log name, let's do system.

712
00:37:00,450 --> 00:37:02,466
Notice tab completion is working in the squigglies, guys.

713
00:37:03,483 --> 00:37:05,450
Let's do newest three.

714
00:37:05,483 --> 00:37:07,466
>> Yeah, good. Carriage return.

715
00:37:08,483 --> 00:37:14,466
Okay, so here's the question: why did we return objects?

716
00:37:14,483 --> 00:37:19,333
Like that looks like text to me and that looks like what I wanted.

717
00:37:19,416 --> 00:37:23,466
Why don't you just do that? And the answer is because it's objects

718
00:37:23,483 --> 00:37:26,466
and objects are awesome. So now what you can do is you can take

719
00:37:26,483 --> 00:37:28,466
that and do... Oh. Go back. Just run it.

720
00:37:28,483 --> 00:37:30,400
>> All right.

721
00:37:30,450 --> 00:37:30,466
>> I need that.

722
00:37:30,483 --> 00:37:31,466
>> Just run it. Okay.

723
00:37:31,483 --> 00:37:33,350
>> Because I can't run this. Okay, so now what you can do is you

724
00:37:33,433 --> 00:37:41,350
can say pipe to sort time. See these aren't sorted by time.

725
00:37:41,433 --> 00:37:41,466
So you get three...

726
00:37:41,483 --> 00:37:42,183
>> So sort it by time.

727
00:37:42,266 --> 00:37:44,316
>> ...from this guy and then three from this guy and three from

728
00:37:44,400 --> 00:37:47,466
those guys. Then say select... oh, sorry, format table.

729
00:37:47,483 --> 00:37:49,466
>> Format table.

730
00:37:50,483 --> 00:37:52,466
>> Let's just say time and message.

731
00:37:52,483 --> 00:37:55,466
>> Property time and message.

732
00:37:57,483 --> 00:37:59,400
Oh we need to do time...

733
00:37:59,483 --> 00:38:00,466
>> Time written?

734
00:38:01,333 --> 00:38:05,466
>> Yeah, time written so let's do time written.

735
00:38:07,483 --> 00:38:09,466
Oops and I need to actually write it in here. You guys get the

736
00:38:09,483 --> 00:38:10,466
idea but let me just get the...

737
00:38:11,483 --> 00:38:14,466
>> And then, maybe it's auto .

738
00:38:14,483 --> 00:38:17,466
>> Oh, this is getting better. And then, with the format commands,

739
00:38:17,483 --> 00:38:19,466
guys, the format commands are wonderful. You should take a look

740
00:38:19,483 --> 00:38:22,233
at them. Format table is one of my favorite ones because it has

741
00:38:22,483 --> 00:38:23,466
auto size.

742
00:38:26,483 --> 00:38:27,466
>> Is that crazy?

743
00:38:27,483 --> 00:38:30,466
>> That is totally crazy. So looking at that one-liner.

744
00:38:31,283 --> 00:38:34,466
What we're bring back... And this is a great thing... is that

745
00:38:34,483 --> 00:38:37,466
we can then continue the pipeline and sort and select and still

746
00:38:37,483 --> 00:38:38,466
work with this.

747
00:38:38,483 --> 00:38:42,466
>> Exactly. That's why the power of objects is so important because

748
00:38:42,483 --> 00:38:45,466
when you and do this stuff, it's not about text. It's about

749
00:38:45,483 --> 00:38:48,466
give me the objects. And now all of a sudden when I'm over there

750
00:38:48,483 --> 00:38:51,0
and I'm doing stuff, I can manipulate the objects there.

751
00:38:51,483 --> 00:38:54,466
And that's great. But when I do remoting what I can do is I can

752
00:38:54,483 --> 00:38:58,466
the objects from a very large set of machines, bring them here

753
00:38:58,483 --> 00:39:02,466
and operate against the objects. So imagine... You say, oh,

754
00:39:02,483 --> 00:39:06,466
I got somebody and I need to give them a share. You can go out

755
00:39:06,483 --> 00:39:10,166
to all of your file servers, get the disk space from all of your

756
00:39:10,483 --> 00:39:13,466
file servers as a collection of objects, sort it by free space

757
00:39:13,483 --> 00:39:16,466
and then, you can say, "Give me the top three." And then, you

758
00:39:16,483 --> 00:39:19,466
can look at those and say, "Yeah, that's the one I want." Imagine

759
00:39:19,483 --> 00:39:22,466
how else you'd do it. You go to this one, find it, write it down.

760
00:39:22,483 --> 00:39:24,466
You go to that one and write it down. You go to that one and...

761
00:39:24,483 --> 00:39:27,466
>> How many of you guys are just still sending people out to do that?

762
00:39:27,483 --> 00:39:30,466
>> Go check that file server and see how much disk space it is.

763
00:39:30,483 --> 00:39:34,466
Put it into the spreadsheet so we can keep track of this as opposed to...

764
00:39:34,483 --> 00:39:36,466
And there's several ways to do it, what he's talking about, but

765
00:39:36,483 --> 00:39:37,466
as opposed to...

766
00:39:39,483 --> 00:39:43,416
Let's just use, what is it, get-volume, right? Is one of the

767
00:39:43,483 --> 00:39:44,366
new commands?

768
00:39:44,450 --> 00:39:44,466
>> Get-disks.

769
00:39:44,483 --> 00:39:46,466
>> I think get-volume will give you free space and size.

770
00:39:46,483 --> 00:39:49,466
>> Okay. Look. We're going to find out in a minute. Oh, size

771
00:39:49,483 --> 00:39:50,466
remaining and size.

772
00:39:50,483 --> 00:39:53,466
>> Ooh, ooh. Yeah, yeah. Do it. Do it. Do it. Do it. Do it.

773
00:39:53,483 --> 00:39:54,466
Do it. Do it.

774
00:39:54,483 --> 00:39:58,466
>> Do it. Do it. Do it. So let's do... What do you want to do?

775
00:39:58,483 --> 00:39:59,450
>> Invoke command.

776
00:39:59,483 --> 00:40:00,466
>> And we'll do it to the...

777
00:40:00,483 --> 00:40:02,350
>> By the way, can we show them the short way?

778
00:40:03,450 --> 00:40:03,466
>> Yeah, and then...

779
00:40:03,483 --> 00:40:05,466
>> This is time. Here's the short way.

780
00:40:05,483 --> 00:40:06,300
>> Yeah.

781
00:40:07,283 --> 00:40:07,466
>> Yeah, ICM.

782
00:40:07,483 --> 00:40:08,383
>> ICM.

783
00:40:08,466 --> 00:40:09,433
>> And then the names. Comp...

784
00:40:09,450 --> 00:40:09,466
>> No, just CN.

785
00:40:10,333 --> 00:40:12,466
>> Or just do the names, yeah, because it's positional. So DC,

786
00:40:12,483 --> 00:40:14,466
S1, S2.

787
00:40:14,483 --> 00:40:15,466
>> That's the short way.

788
00:40:15,483 --> 00:40:17,466
>> And we want to do...

789
00:40:17,166 --> 00:40:17,466
>> Get-volume.

790
00:40:17,483 --> 00:40:18,466
>> ...let's see, get-volume.

791
00:40:19,483 --> 00:40:21,216
>> And pipe it to sort size remaining.

792
00:40:21,300 --> 00:40:26,466
>> Get-volume sort size...

793
00:40:28,483 --> 00:40:32,466
I can't spell anymore. It's been a long day... sort size remaining.

794
00:40:33,166 --> 00:40:37,466
Let's just try that and see what we get. Oh god, look.

795
00:40:38,483 --> 00:40:40,466
Look, look, look. Size remaining...

796
00:40:40,483 --> 00:40:42,466
>> No, wait. Wait, wait. Now here's the thing. Go back up.

797
00:40:42,483 --> 00:40:43,466
Scroll up.

798
00:40:43,483 --> 00:40:45,450
>> Scroll up. Scroll up.

799
00:40:46,366 --> 00:40:50,466
Okay, notice how the formatting... No, I want to show the previous text.

800
00:40:50,483 --> 00:40:51,466
>> Oh, the previous one. Okay.

801
00:40:51,483 --> 00:40:54,466
>> So notice here, it just shows you drive letter, da, da, da,

802
00:40:54,483 --> 00:40:59,466
to size. But now you go scroll down, notice we have PS computer name.

803
00:40:59,483 --> 00:41:00,166
>> Yay.

804
00:41:00,250 --> 00:41:04,466
>> When the objects come back we add properties to it. And we

805
00:41:04,216 --> 00:41:08,466
add, "Where did this thing come from?" So when I do this sort

806
00:41:08,216 --> 00:41:11,466
and then we go down to the bottom, I can see, okay, there's my volume.

807
00:41:11,483 --> 00:41:14,466
But where did that volume come from? And the answer is S2.

808
00:41:15,383 --> 00:41:17,466
>> That's right. So, guys...

809
00:41:17,483 --> 00:41:18,466
>> Party on my friends.

810
00:41:18,483 --> 00:41:22,466
>> Here's the thing: that cmdlet you can just say just show me

811
00:41:22,483 --> 00:41:25,466
the C drive. You can sort and filter this out more where I just

812
00:41:25,483 --> 00:41:29,466
want to see the computer name and size remaining and just get

813
00:41:29,483 --> 00:41:34,200
a nice, short, terse list then export to CSV. You got your report

814
00:41:34,283 --> 00:41:37,466
done and you did it on as many computers as you wanted to in seconds.

815
00:41:37,483 --> 00:41:39,466
>> Oh, should we show them select last?

816
00:41:40,483 --> 00:41:41,400
Yeah, show that.

817
00:41:41,483 --> 00:41:42,466
>> Oh, yeah. Yeah, yeah, yeah, yeah.

818
00:41:42,483 --> 00:41:45,450
>> So like if I had done this to like lots of machines and they

819
00:41:45,483 --> 00:41:47,466
were file servicing lots of stuff on it, this would be pretty big.

820
00:41:47,483 --> 00:41:50,466
And you don't want to mess with that. So what you do is you

821
00:41:50,483 --> 00:41:51,466
say select minus last.

822
00:41:52,483 --> 00:41:54,466
Let's pick the last three.

823
00:41:56,383 --> 00:41:59,266
>> And what it'll do is give you the last three, just exactly

824
00:41:59,350 --> 00:42:00,0
what you think it would do.

825
00:42:00,450 --> 00:42:00,466
>> Boom.

826
00:42:00,483 --> 00:42:02,466
>> Boom. And there's the last three.

827
00:42:03,300 --> 00:42:04,466
>> PowerShell rocks.

828
00:42:04,483 --> 00:42:07,450
>> PowerShell so rocks. We have first; we have last. There are

829
00:42:07,483 --> 00:42:09,466
all kinds of ways. This is the importance of taking a look at...

830
00:42:10,333 --> 00:42:10,466
>> Skip.

831
00:42:10,233 --> 00:42:13,450
>> ...those help files. Skip, exactly. So make sure you look

832
00:42:13,483 --> 00:42:16,466
inside these help files because you can do it. It's not something,

833
00:42:16,483 --> 00:42:19,466
"Well I can't figure out how to do it." You don't need bizarre

834
00:42:19,483 --> 00:42:22,466
long links of code; you need to look at the help files.

835
00:42:22,483 --> 00:42:24,266
They really thought this stuff through.

836
00:42:24,350 --> 00:42:26,183
>> And if you get stuck, PowerShell.org...

837
00:42:26,266 --> 00:42:26,466
>> .org.

838
00:42:26,483 --> 00:42:27,466
>> ...forums.

839
00:42:27,483 --> 00:42:28,466
>> And ask on the forum.

840
00:42:28,483 --> 00:42:31,466
>> Yeah, lots of really helpful people out there. And just as

841
00:42:31,483 --> 00:42:37,0
a side note, it's fascinating how strong the PowerShell community is.

842
00:42:37,450 --> 00:42:37,466
>> It is, yeah.

843
00:42:37,483 --> 00:42:40,466
>> You guys have noticed that this is not necessarily the easiest

844
00:42:40,483 --> 00:42:43,200
tool in the world for you to learn. It's the most powerful one

845
00:42:43,283 --> 00:42:46,466
in your toolbox but it's not an easy tool to learn because you're

846
00:42:46,483 --> 00:42:50,466
just staring at a prompt, "And now what do I do?" We've all gone

847
00:42:50,483 --> 00:42:53,466
through this, and so the PowerShell community is so strong; they

848
00:42:53,483 --> 00:42:57,466
want to help you so avail yourself of those resources. And I'll

849
00:42:57,483 --> 00:42:59,466
give you some more here a little bit.

850
00:42:59,483 --> 00:43:00,433
>> Yeah, can I riff on that a second?

851
00:43:00,450 --> 00:43:00,466
>> Yeah.

852
00:43:00,483 --> 00:43:04,316
>> So here's the thing: we found as we were rolling out PowerShell

853
00:43:04,400 --> 00:43:07,366
that the community just flourished and it's like wow. And people

854
00:43:07,450 --> 00:43:09,466
are having a blast. Now here's the interesting thing, it turns

855
00:43:09,483 --> 00:43:13,466
out that this, this like hurts the community. No, seriously.

856
00:43:13,483 --> 00:43:16,466
It hurts the community. Why? And we noticed this because as some

857
00:43:16,483 --> 00:43:19,166
point we were putting things together and then, we were like,

858
00:43:19,250 --> 00:43:21,383
"Hey, did you see what Bruce did?" No, what did Bruce do?

859
00:43:21,466 --> 00:43:24,250
We all run into Bruce's office and he shows what he does.

860
00:43:24,333 --> 00:43:26,466
And it's like, "Oh man, that's awesome. Can you send that to

861
00:43:26,483 --> 00:43:29,466
me?" He sends it to me and I'm doing it. And then, I change it.

862
00:43:29,166 --> 00:43:30,466
And they're like, "Oh, Joe, check out what Jeffrey did." And

863
00:43:31,0 --> 00:43:34,466
everybody comes running. And we were having a blast with this.

864
00:43:34,483 --> 00:43:37,466
And we talked about this a little last night, we said, "Boy,

865
00:43:37,483 --> 00:43:42,466
we're really having fun here." And computers always used to be fun.

866
00:43:42,233 --> 00:43:45,466
And then for some point they stopped being fun and it just seemed

867
00:43:45,483 --> 00:43:46,466
like it was a job.

868
00:43:46,483 --> 00:43:47,466
>> It became mundane.

869
00:43:48,0 --> 00:43:51,466
>> And I think it was because of this damn thing, the mouse.

870
00:43:51,483 --> 00:43:57,333
And so here's the idea: I never, never, never say, "Hey come

871
00:43:57,483 --> 00:44:00,466
one, guys, did you check to see the way Jason was clicking that mouse?

872
00:44:01,483 --> 00:44:04,466
My god, you are such a clever guy. Did you see the snap on that

873
00:44:04,483 --> 00:44:05,433
thing?" >> See,

874
00:44:05,483 --> 00:44:08,466
I love you, man, because I work on my mouse moves.

875
00:44:08,483 --> 00:44:13,316
>> Well, no that's the point. So when I see program, when you

876
00:44:13,400 --> 00:44:16,466
script and you write together this command line, I see how you

877
00:44:16,483 --> 00:44:19,466
think and I'm able to say, "Wow, that's really clever.

878
00:44:19,483 --> 00:44:24,333
That's really neat." Then I say, "Oh, can I have that?" >> Right.

879
00:44:24,483 --> 00:44:26,466
>> And you give it to me and all of a sudden you've helped me.

880
00:44:26,483 --> 00:44:31,233
Like say you're a god at clicking that mouse, right? How can

881
00:44:31,316 --> 00:44:34,466
you help me? Like, step back and be impressed, I guess.

882
00:44:34,483 --> 00:44:36,466
>> Nice clicking.

883
00:44:36,166 --> 00:44:39,466
>> You can't help me. But with a script you can help me. And I

884
00:44:39,483 --> 00:44:42,233
can take it and I modify it and it meets my needs. And I look

885
00:44:42,316 --> 00:44:44,466
great to my boss. And now all of a sudden, you know what, two

886
00:44:44,483 --> 00:44:48,233
things: one is you feel good because you helped me. Two, I have

887
00:44:48,316 --> 00:44:50,466
a debt of gratitude to you. I mean, thank you very much.

888
00:44:50,483 --> 00:44:53,466
That's very awesome. And I'll buy you a beer or something like

889
00:44:53,483 --> 00:44:56,466
that, and also I say, "Hey, you know what, I should help other

890
00:44:56,483 --> 00:45:00,466
people too." So really you should help other people. First, be

891
00:45:00,483 --> 00:45:03,466
aware there are lots of people in the community out there more

892
00:45:03,483 --> 00:45:07,466
than willing to help. You should not be suffering in silence.

893
00:45:07,483 --> 00:45:11,466
No, no, no if you're confused or anything, I guarantee you nobody

894
00:45:11,483 --> 00:45:15,383
is going to be... you should not be embarrassed by any of your questions.

895
00:45:15,466 --> 00:45:18,466
People aren't going to make fun of you. That's not going to happen.

896
00:45:18,483 --> 00:45:22,433
The barrier for you asking a question should be extraordinarily low.

897
00:45:22,483 --> 00:45:25,466
Just ask the question in a form, in Twitter. Twitter is a very

898
00:45:25,483 --> 00:45:29,466
useful place as well. Just ask that question. People will help you.

899
00:45:29,483 --> 00:45:33,466
And it turns out and then you should participate. You should

900
00:45:33,483 --> 00:45:36,450
say, "Hey, I found this clever way to do things." You should

901
00:45:36,483 --> 00:45:39,233
blog things. And here's the great thing, right, so you might

902
00:45:39,316 --> 00:45:41,466
now I've been doing this PowerShell things for a little while.

903
00:45:41,483 --> 00:45:44,466
I blog things. I blog things and say, "Oh, here's what I do."

904
00:45:45,483 --> 00:45:48,333
And people will say, "Geez, why do you do it that way? Why didn't

905
00:45:48,483 --> 00:45:50,466
you do it this way?" And it's like, "I didn't know you could

906
00:45:50,483 --> 00:45:53,466
do it that way." And so the community is teaching me how to do things.

907
00:45:53,483 --> 00:45:55,466
Honestly, it's just a wonderful thing.

908
00:45:55,483 --> 00:46:00,233
>> And I have to say it's truly amazing. And remember when computers

909
00:46:00,316 --> 00:46:02,466
were fun when it wasn't, "I need to reset a bunch passwords,"

910
00:46:02,483 --> 00:46:03,466
and you just sat there and went like this....

911
00:46:04,450 --> 00:46:04,466
>> Click, click, click, click.

912
00:46:04,483 --> 00:46:07,350
>> Where now you're actually going, "Oh, I'm going to figure out

913
00:46:07,433 --> 00:46:09,266
how to reset these passwords. Or I'm going to figure out how

914
00:46:09,350 --> 00:46:12,250
to do X, Y, Z." Awesome.

915
00:46:12,483 --> 00:46:15,466
And now I'm going to automate it so I never have to do it again.

916
00:46:15,483 --> 00:46:19,466
But it was fun figuring out the problem. It used to be fun solving

917
00:46:19,483 --> 00:46:23,466
the problem. And PowerShell has brought that back, and the community

918
00:46:23,483 --> 00:46:25,466
is really strong with that. Folks, so here's what we're going

919
00:46:25,483 --> 00:46:29,466
to do. Is let me show the... Just to let you know that all of

920
00:46:29,483 --> 00:46:33,416
this stuff we did in remoting is in the slides. And I'm just

921
00:46:33,483 --> 00:46:35,316
going to go through these real quick. But it's not the end yet

922
00:46:35,400 --> 00:46:37,466
of remoting; we've got some more stuff to do but we want to start

923
00:46:37,483 --> 00:46:41,466
some automation and some scripting to come up. And so we're

924
00:46:41,483 --> 00:46:44,466
going to kind of get started on this before we take a break.

925
00:46:44,483 --> 00:46:47,466
So if you have questions or comments, please make sure you're

926
00:46:47,483 --> 00:46:49,466
jumping out there. And we're going to come back to remoting in

927
00:46:49,483 --> 00:46:53,316
just a second. But before we take a break, let's get started

928
00:46:53,400 --> 00:46:58,466
on this concept of automation. And to do that, we need to start

929
00:46:58,483 --> 00:47:02,466
to talk about things like security because we're going to start

930
00:47:02,483 --> 00:47:06,466
about scripting now. And so we're going to take the commands

931
00:47:06,483 --> 00:47:09,466
that you're building as one-liners and so forth, and we're going

932
00:47:09,483 --> 00:47:12,433
to take those commands and now automate them by putting them

933
00:47:12,483 --> 00:47:15,466
into a script and just telling the script to run them for us.

934
00:47:15,483 --> 00:47:19,466
No major deal yet. It's pretty straightforward. But to run a

935
00:47:19,483 --> 00:47:22,333
script requires some special security. So we're going to talk

936
00:47:22,416 --> 00:47:24,466
about security. We're going to talk about variables, a place

937
00:47:24,483 --> 00:47:27,466
to store your stuff. Maybe a little bit with quotes and then,

938
00:47:27,483 --> 00:47:31,466
we'll start getting into the automation. So the first thing off...

939
00:47:31,483 --> 00:47:33,466
And by the way, that's a picture of me right there, the big guy.

940
00:47:33,483 --> 00:47:34,466
>> Ooh.

941
00:47:34,483 --> 00:47:37,433
>> On the next screen, usually people say that's the picture of

942
00:47:37,450 --> 00:47:37,466
me but .

943
00:47:37,483 --> 00:47:38,450
>> I see.

944
00:47:38,483 --> 00:47:43,466
>> Oh no. The guys in the back are going, "Yep, that's it." So

945
00:47:43,483 --> 00:47:49,416
PowerShell is secured by default several different ways.

946
00:47:49,483 --> 00:47:52,466
Now we had some problems in the past with... Like VB script,

947
00:47:52,483 --> 00:47:53,466
you double-click on it and it runs.

948
00:47:53,483 --> 00:47:54,466
>> Oh god, yeah.

949
00:47:55,483 --> 00:47:57,466
>> Talk a little bit about what PowerShell does for us.

950
00:47:57,483 --> 00:48:00,466
>> Yeah, so okay again remember it is secure by default. We did

951
00:48:01,0 --> 00:48:05,233
this: secure, secure, secure. So what happened if you weren't

952
00:48:05,316 --> 00:48:08,433
around then, people came in one morning...

953
00:48:08,450 --> 00:48:08,466
>> Oh god, yeah.

954
00:48:08,483 --> 00:48:11,466
>> ...and they got their mail, "I love you." And they're like,

955
00:48:11,483 --> 00:48:15,466
"Oh, I feel special. I've got a secret admirer." And even the

956
00:48:15,483 --> 00:48:20,466
people like, "I bet that's not true, but it might be." >> That's

957
00:48:20,483 --> 00:48:21,466
right. So, "I want to find out." >> "I

958
00:48:21,483 --> 00:48:25,466
want to find out who loves me." Click, click. And then it would run.

959
00:48:25,483 --> 00:48:29,233
You click and this thing would run. And guess what? Bad things happened.

960
00:48:29,316 --> 00:48:29,466
>> Bad things happened.

961
00:48:29,483 --> 00:48:32,466
>> Anybody who's like giving you something free or promising to

962
00:48:32,483 --> 00:48:36,466
grow or shrink your body parts just with money, it just doesn't work.

963
00:48:37,483 --> 00:48:40,466
And so too if somebody sends you love, don't click on that stuff.

964
00:48:40,483 --> 00:48:43,466
Anyway, so with PowerShell somebody sends you that and you double-click

965
00:48:44,166 --> 00:48:47,466
on it, it brings up in the editor. It doesn't run it.

966
00:48:47,483 --> 00:48:48,466
>> It doesn't run it.

967
00:48:48,483 --> 00:48:50,450
>> That is the key.

968
00:48:50,483 --> 00:48:53,466
>> So let me do a quick demonstration of that. Let's just make

969
00:48:53,483 --> 00:48:57,283
a really quick script. And, guys, it'll get cooler than this

970
00:48:57,366 --> 00:48:59,466
but I'm going to make a really quick script. And I've been doing

971
00:48:59,483 --> 00:49:02,166
this get-service Bits all morning; I'm getting sick and tired

972
00:49:02,250 --> 00:49:04,466
of typing this in. And I'm going to make sure that it works.

973
00:49:04,483 --> 00:49:08,466
It works. I'm going to take this right now and I'm going to copy it.

974
00:49:08,483 --> 00:49:13,466
And I'm going to start up Notepad and I'm going... Yeah, we're

975
00:49:13,483 --> 00:49:15,466
using Notepad right now. Don't worry, we're going to get to the ISE.

976
00:49:15,483 --> 00:49:20,166
I'm going to paste it in there. File, save as. And here's the

977
00:49:20,483 --> 00:49:23,166
magic to making a script... Well, let me put it on my desktop

978
00:49:23,250 --> 00:49:26,466
so we can see it... is what do you want to call this script?

979
00:49:26,183 --> 00:49:26,466
Let's call it...

980
00:49:26,483 --> 00:49:27,466
>> I love you.

981
00:49:27,483 --> 00:49:35,233
>> ...I love you. I love you. And let's .PS1. PS1. And I don't

982
00:49:35,316 --> 00:49:37,466
actually want to put it on my desktop.

983
00:49:37,483 --> 00:49:38,466
>> No.

984
00:49:38,166 --> 00:49:40,466
>> I'm going to put it under my scripts folder here so I can get

985
00:49:40,483 --> 00:49:44,466
to it. And wait a minute, there's a scripts folder right there.

986
00:49:44,483 --> 00:49:45,466
Iloveyou.PS1.

987
00:49:45,483 --> 00:49:46,466
>> You've got to get rid of the text.

988
00:49:47,483 --> 00:49:48,466
>> I got to... Oh.

989
00:49:48,483 --> 00:49:50,466
>> Yeah. All files, right there.

990
00:49:50,483 --> 00:49:52,466
>> All files. And save.

991
00:49:52,183 --> 00:49:54,466
>> Stick with me, guy, I'll help you out.

992
00:49:54,483 --> 00:49:59,466
>> You're the man. So I've got a script. What I want you to see

993
00:49:59,200 --> 00:50:01,466
is, yes, I'm going to show you this graphically first because

994
00:50:01,483 --> 00:50:04,466
I want you to see what Jeffrey just said. I'm going to go out here.

995
00:50:04,483 --> 00:50:08,466
And if somebody were to send this to me, Iloveyou.PS1, and I'm

996
00:50:08,483 --> 00:50:14,466
going to double-click it. See? Brings it up in Notepad or whatever

997
00:50:14,483 --> 00:50:15,466
editor you have set for it....

998
00:50:15,483 --> 00:50:16,450
>> They didn't love you.

999
00:50:16,483 --> 00:50:17,433
>> They what?

1000
00:50:17,450 --> 00:50:17,466
>> They didn't love you.

1001
00:50:18,166 --> 00:50:20,466
>> They didn't actually love me. It didn't execute my script.

1002
00:50:20,483 --> 00:50:23,466
Now this is a good thing for so many reasons as you guys already know.

1003
00:50:23,483 --> 00:50:25,466
You don't want scripts to automatically execute. But I want

1004
00:50:25,483 --> 00:50:28,466
to bring something up: a lot of the security that we're going

1005
00:50:28,483 --> 00:50:31,466
to be talking about in the next thing which is execution policy

1006
00:50:31,483 --> 00:50:34,466
which we're going to do before we go on break, I need to tell

1007
00:50:34,483 --> 00:50:42,216
you that this security is designed to take an unintentional user

1008
00:50:42,300 --> 00:50:45,466
to stop them from doing unintentionally malicious things.

1009
00:50:45,483 --> 00:50:48,466
In other words, I want you to think about I downloaded a script,

1010
00:50:48,483 --> 00:50:51,433
I double-click on it; I didn't want it to run. I wanted to look

1011
00:50:51,450 --> 00:50:51,466
at it.

1012
00:50:53,483 --> 00:50:54,466
This helps you.

1013
00:50:55,400 --> 00:51:00,466
Now if you are a power-user that wants to be malicious, can we

1014
00:51:00,483 --> 00:51:01,466
change this?

1015
00:51:02,250 --> 00:51:03,300
Well, yeah.

1016
00:51:03,483 --> 00:51:04,466
>> Power.

1017
00:51:04,483 --> 00:51:08,466
>> I mean, yeah. I know how to change the association of PS1 to

1018
00:51:08,483 --> 00:51:12,466
make it actually execute. That's not just a good idea.

1019
00:51:12,483 --> 00:51:14,466
>> Yeah, don't do that. Don't do that.

1020
00:51:14,483 --> 00:51:16,466
>> The point is, is we're not going to stop you from doing that.

1021
00:51:16,483 --> 00:51:20,466
But this helps you from making foolish mistakes like this.

1022
00:51:20,483 --> 00:51:23,433
So let's try to execute this script and watch what happens.

1023
00:51:23,483 --> 00:51:27,466
There's another security feature. The whole path thing, you

1024
00:51:27,483 --> 00:51:28,466
make us type in the path.

1025
00:51:28,483 --> 00:51:31,333
>> Yeah, well, first just try and type it.

1026
00:51:31,483 --> 00:51:34,466
>> So C colon scripts and it was Iloveyou.PS1....

1027
00:51:34,483 --> 00:51:36,466
>> Well, no just CD to there. CD to that directory.

1028
00:51:36,483 --> 00:51:39,216
>> Oh, okay. You want me to CD to it, okay.

1029
00:51:39,300 --> 00:51:40,466
>> And then just type I love you.

1030
00:51:41,333 --> 00:51:43,466
>> Oh, I love you.

1031
00:51:43,483 --> 00:51:44,466
>> Ipe love you?

1032
00:51:44,166 --> 00:51:47,466
>> No, that's not going to work. IP... Well, I love IP but .

1033
00:51:47,483 --> 00:51:48,166
>> I love IP.

1034
00:51:48,483 --> 00:51:52,466
>> I love IP. IP therefore I am. There we go. I love you. What? What? What? What?

1035
00:51:52,483 --> 00:51:55,466
>> See. It says, "No. No, no, no, my friend." >> No,

1036
00:51:55,483 --> 00:51:59,466
not recognized as the name of a cmdlet, a function or a script file.

1037
00:52:00,166 --> 00:52:01,350
Check the spelling.

1038
00:52:01,433 --> 00:52:01,466
Well...

1039
00:52:02,483 --> 00:52:03,466
>> Look at the suggestion. Have you ever noticed that?

1040
00:52:04,0 --> 00:52:04,466
>> Oh, oh, dude.

1041
00:52:04,483 --> 00:52:05,466
>> You haven't noticed that?

1042
00:52:05,483 --> 00:52:08,466
>> That command I love you was not found but does exist in the

1043
00:52:08,483 --> 00:52:10,250
current location.

1044
00:52:10,333 --> 00:52:10,466
>> You never noticed that?

1045
00:52:10,483 --> 00:52:12,466
>> I never noticed that. Tricky, tricky.

1046
00:52:13,450 --> 00:52:13,466
>> Yeah.

1047
00:52:13,483 --> 00:52:15,466
>> So now that's just going to confuse me more because it's going

1048
00:52:15,483 --> 00:52:18,466
to say... Oh, but then it actually tells me how to solve it.

1049
00:52:18,483 --> 00:52:22,466
>> Yeah, type dot slash. Now here's the reason why. This is what's

1050
00:52:22,483 --> 00:52:26,266
called kind of a trolling attack. So what happened is...

1051
00:52:26,350 --> 00:52:30,466
And this is only time UNIX problem. You're admin and you CD

1052
00:52:30,483 --> 00:52:33,333
to somewhere and you say, "Current working directory." And a

1053
00:52:33,416 --> 00:52:36,466
bad guy would go in that directory, and they'd put something

1054
00:52:36,483 --> 00:52:38,466
called print working directory. They would rename Iloveyou.vbs

1055
00:52:38,483 --> 00:52:42,466
to print working directory. So you CD there. You do print working

1056
00:52:42,483 --> 00:52:44,466
directory; you run that code.

1057
00:52:46,483 --> 00:52:49,466
And bad things would happen. And so what we said was, "No, no, no.

1058
00:52:49,483 --> 00:52:51,466
If you want to run something in the current directory, you have

1059
00:52:52,483 --> 00:52:56,466
to be clear that that's what you want to do." We're very big

1060
00:52:56,483 --> 00:53:00,183
on intentionality. You have to tell me that that's what you want;

1061
00:53:00,266 --> 00:53:01,466
otherwise, no.

1062
00:53:01,483 --> 00:53:03,433
>> I remember root kits used to come in...

1063
00:53:03,450 --> 00:53:03,466
>> Root kits.

1064
00:53:03,483 --> 00:53:06,466
>> ...and there was a DIR root kit. And you would go DIR and

1065
00:53:06,483 --> 00:53:08,466
you were running the root kit.

1066
00:53:08,483 --> 00:53:09,466
>> Yeah, bad.

1067
00:53:09,483 --> 00:53:12,466
>> Yeah, bad, bad. So what this prevents from is... Let me show

1068
00:53:12,483 --> 00:53:15,466
you this two ways. One is I could try to run the script by typing

1069
00:53:15,483 --> 00:53:21,466
in the full path to the script, I love you, or I can be in the

1070
00:53:21,483 --> 00:53:23,466
current directory and let me show you that one. If I'm in the

1071
00:53:23,483 --> 00:53:25,466
current directory with the script and try to run it,

1072
00:53:27,483 --> 00:53:32,466
it's dot slash Iloveyou.PS1 and that's what that general message

1073
00:53:32,483 --> 00:53:36,466
at the bottom told you to do because it saw it there. This will

1074
00:53:36,483 --> 00:53:37,466
run my script.

1075
00:53:38,483 --> 00:53:42,466
Oh, no. I'm a failure. I'm a failure in life because it found

1076
00:53:42,483 --> 00:53:46,466
it, but it says it can't be loaded because the running of scripts

1077
00:53:46,483 --> 00:53:50,466
is disabled on this system. For more information . In other

1078
00:53:50,233 --> 00:53:52,466
words, you're not allowed to run scripts. And when we come back

1079
00:53:52,483 --> 00:53:57,466
from break, we're going to show you why you're not allowed scripts

1080
00:53:57,483 --> 00:54:01,466
and then how to change that. So we'll see you guys in ten minutes.

1081
00:54:01,483 --> 00:54:03,466
Yeah? Ten minutes. >> Cheers.

